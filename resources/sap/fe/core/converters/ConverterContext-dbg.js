sap.ui.define(["sap/fe/core/converters/ManifestSettings", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/templating/DataModelPathHelper"], function (ManifestSettings, MetaModelConverter, DataModelPathHelper) {
  "use strict";

  var _exports = {};
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var convertTypes = MetaModelConverter.convertTypes;
  var createManifestWrapper = ManifestSettings.createManifestWrapper;

  /**
   * Checks whether an object is an annotation term.
   *
   * @param {string|AnnotationTerm<object>} vAnnotationPath
   * @returns {boolean}
   */
  var isAnnotationTerm = function (vAnnotationPath) {
    return typeof vAnnotationPath === "object";
  };

  var getDataModelPathForEntitySet = function (entitySet) {
    var dataModelPath = {
      startingEntitySet: entitySet,
      targetEntityType: entitySet.entityType,
      targetEntitySet: entitySet,
      navigationProperties: [],
      contextLocation: undefined,
      targetObject: entitySet
    };
    dataModelPath.contextLocation = dataModelPath;
    return dataModelPath;
  };
  /**
   * Create a ConverterContext object that will be used within the converters.
   *
   * @param {ConverterOutput} oConvertedTypes the converted annotation and service types
   * @param {BaseManifestSettings} oManifestSettings the manifestSettings that applies to this page
   * @param {TemplateType} templateType the type of template we're looking at right now
   * @param {IShellServicesProxy} shellServices the current instance of the shellservice
   * @param {IDiagnostics} diagnostics the diagnostics shim
   * @param {Function} mergeFn the function to be used to perfom some deep merges between object
   * @param {DataModelObjectPath} targetDataModelPath the global path to reach the entitySet
   *
   * @returns {ConverterContext} a converter context for the converters
   */


  function createConverterContext(oConvertedTypes, oManifestSettings, templateType, shellServices, diagnostics, mergeFn, targetDataModelPath) {
    var oManifestWrapper = createManifestWrapper(oManifestSettings, mergeFn);
    var sBaseContextPath = getTargetObjectPath(targetDataModelPath);

    var getEntityTypeFromFullyQualifiedName = function (fullyQualifiedName) {
      var targetEntityType = oConvertedTypes.entityTypes.find(function (entityType) {
        if (fullyQualifiedName.startsWith(entityType.fullyQualifiedName)) {
          var replaceAnnotation = fullyQualifiedName.replace(entityType.fullyQualifiedName, "");
          return replaceAnnotation.startsWith("/") || replaceAnnotation.startsWith("@");
        }

        return false;
      });
      return targetEntityType;
    };

    var getAnnotationEntityType = function (annotation) {
      if (annotation) {
        var annotationPath = annotation.fullyQualifiedName;
        var targetEntityType = getEntityTypeFromFullyQualifiedName(annotationPath);

        if (!targetEntityType) {
          throw new Error("Cannot find Entity Type for " + annotation.fullyQualifiedName);
        }

        return targetEntityType;
      } else {
        return targetDataModelPath.targetEntityType;
      }
    };

    var getManifestControlConfiguration = function (vAnnotationPath) {
      if (isAnnotationTerm(vAnnotationPath)) {
        return oManifestWrapper.getControlConfiguration(getRelativeAnnotationPath(vAnnotationPath.fullyQualifiedName, targetDataModelPath.targetEntityType));
      }

      return oManifestWrapper.getControlConfiguration(vAnnotationPath);
    };

    var getAbsoluteAnnotationPath = function (sAnnotationPath) {
      if (!sAnnotationPath) {
        return sAnnotationPath;
      }

      if (sAnnotationPath[0] === "/") {
        return sAnnotationPath;
      }

      return sBaseContextPath + "/" + sAnnotationPath;
    };

    var getEntitySet = function () {
      return targetDataModelPath.targetEntitySet;
    };

    var getDataModelObjectPath = function () {
      return targetDataModelPath;
    };

    var findEntitySet = function (entitySetName) {
      if (entitySetName === undefined) {
        return targetDataModelPath.targetEntitySet;
      }

      return oConvertedTypes.entitySets.find(function (entitySet) {
        return entitySet.name === entitySetName;
      });
    };

    var getEntitySetForEntityType = function (entityType) {
      return oConvertedTypes.entitySets.find(function (entitySet) {
        return entitySet.entityType === entityType;
      });
    };

    var getEntityType = function () {
      return targetDataModelPath.targetEntityType;
    };

    var getEntityPropertyFromFullyQualifiedName = function (fullyQualifiedName) {
      if (fullyQualifiedName) {
        var _targetEntityType$ent;

        var targetEntityType = getEntityTypeFromFullyQualifiedName(fullyQualifiedName);
        return targetEntityType === null || targetEntityType === void 0 ? void 0 : (_targetEntityType$ent = targetEntityType.entityProperties) === null || _targetEntityType$ent === void 0 ? void 0 : _targetEntityType$ent.find(function (propertyName) {
          return propertyName.name === fullyQualifiedName.split("/").pop();
        });
      }

      return undefined;
    };

    var getEntityTypeAnnotation = function (annotationPath) {
      if (annotationPath.indexOf("@") === -1) {
        annotationPath = "@" + annotationPath;
      }

      var targetObject = targetDataModelPath.targetEntityType.resolvePath(annotationPath, true);
      var rootEntitySet = targetDataModelPath.targetEntitySet;
      var currentEntityType = targetDataModelPath.targetEntityType;
      var navigationProperties = targetDataModelPath.navigationProperties.concat();
      var i = 1;
      var currentObject;
      var navigatedPaths = [];

      while (i < targetObject.visitedObjects.length) {
        currentObject = targetObject.visitedObjects[i++];

        if (currentObject._type === "NavigationProperty") {
          navigatedPaths.push(currentObject.name);
          navigationProperties.push(currentObject);
          currentEntityType = currentObject.targetType;

          if (rootEntitySet && rootEntitySet.navigationPropertyBinding.hasOwnProperty(navigatedPaths.join("/"))) {
            rootEntitySet = rootEntitySet.navigationPropertyBinding[currentObject.name];
            navigatedPaths = [];
          }
        }

        if (currentObject._type === "EntitySet") {
          rootEntitySet = currentObject;
          currentEntityType = rootEntitySet.entityType;
        }
      }

      var outDataModelPath = {
        startingEntitySet: targetDataModelPath.startingEntitySet,
        targetEntitySet: rootEntitySet,
        targetEntityType: currentEntityType,
        targetObject: navigationProperties[navigationProperties.length - 1],
        navigationProperties: navigationProperties,
        contextLocation: targetDataModelPath.contextLocation
      };
      return {
        annotation: targetObject.target,
        converterContext: createConverterContext(oConvertedTypes, oManifestSettings, templateType, shellServices, diagnostics, mergeFn, outDataModelPath)
      };
    };

    var getTemplateType = function () {
      return templateType;
    };

    var getRelativeAnnotationPath = function (annotationPath, entityType) {
      return annotationPath.replace(entityType.fullyQualifiedName, "");
    };

    var getEntitySetBasedAnnotationPath = function (annotationPath) {
      if (!annotationPath) {
        return annotationPath;
      }

      var entityTypeFQN = targetDataModelPath.targetEntityType.fullyQualifiedName;

      if (targetDataModelPath.targetEntitySet) {
        var replacedAnnotationPath = annotationPath.replace(entityTypeFQN, "/");

        if (replacedAnnotationPath.length > 2 && replacedAnnotationPath[0] === "/" && replacedAnnotationPath[1] === "/") {
          replacedAnnotationPath = replacedAnnotationPath.substr(1);
        }

        return sBaseContextPath + replacedAnnotationPath;
      } else {
        return "/" + annotationPath;
      }
    };

    var getManifestWrapper = function () {
      return oManifestWrapper;
    };

    var getShellServices = function () {
      return shellServices;
    };

    var getDiagnostics = function () {
      return diagnostics;
    };

    var getConverterContextFor = function (targetEntitySet) {
      var targetPath = getDataModelPathForEntitySet(targetEntitySet);
      return createConverterContext(oConvertedTypes, oManifestSettings, templateType, shellServices, diagnostics, mergeFn, targetPath);
    };

    var getAnnotationByType = function (vocabularyName, annotationTerm) {
      var entityType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : getEntityType();
      var annotations = (entityType === null || entityType === void 0 ? void 0 : entityType.annotations[vocabularyName]) || {};
      var outAnnotations = [];

      if (annotations) {
        outAnnotations = Object.keys(annotations).filter(function (annotation) {
          return annotations[annotation].term === annotationTerm;
        }).reduce(function (previousValue, key) {
          previousValue.push(annotations[key]);
          return previousValue;
        }, []);
      }

      return outAnnotations;
    };

    var getEntityContainer = function () {
      return oConvertedTypes.entityContainer;
    };

    return {
      getAnnotationEntityType: getAnnotationEntityType,
      getManifestControlConfiguration: getManifestControlConfiguration,
      getAbsoluteAnnotationPath: getAbsoluteAnnotationPath,
      getEntitySet: getEntitySet,
      getDataModelObjectPath: getDataModelObjectPath,
      findEntitySet: findEntitySet,
      getEntitySetForEntityType: getEntitySetForEntityType,
      getEntityType: getEntityType,
      getEntityTypeAnnotation: getEntityTypeAnnotation,
      getTemplateType: getTemplateType,
      getRelativeAnnotationPath: getRelativeAnnotationPath,
      getEntitySetBasedAnnotationPath: getEntitySetBasedAnnotationPath,
      getManifestWrapper: getManifestWrapper,
      getShellServices: getShellServices,
      getDiagnostics: getDiagnostics,
      getConverterContextFor: getConverterContextFor,
      getEntityPropertyFromFullyQualifiedName: getEntityPropertyFromFullyQualifiedName,
      getAnnotationByType: getAnnotationByType,
      getEntityContainer: getEntityContainer
    };
  }
  /**
   * Create the converter context necessary for a macro based on a metamodel context.
   * @param sEntitySetName
   * @param oMetaModelContext
   * @param templateType
   * @param shellServices
   * @param diagnostics
   * @param mergeFn
   * @param targetDataModelPath
   * @param manifestSettings
   * @returns {ConverterContext} the current converter context
   */


  _exports.createConverterContext = createConverterContext;

  function createConverterContextForMacro(sEntitySetName, oMetaModelContext, templateType, shellServices, diagnostics, mergeFn, targetDataModelPath) {
    var manifestSettings = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : {};
    var oMetaModel = oMetaModelContext.isA("sap.ui.model.odata.v4.ODataMetaModel") ? oMetaModelContext : oMetaModelContext.getModel();
    var oConverterOutput = convertTypes(oMetaModel);
    var targetEntitySet = oConverterOutput.entitySets.find(function (entitySet) {
      return entitySet.name === sEntitySetName;
    });

    if (!targetDataModelPath) {
      targetDataModelPath = {
        startingEntitySet: targetEntitySet,
        navigationProperties: [],
        targetEntitySet: targetEntitySet,
        targetEntityType: targetEntitySet.entityType,
        targetObject: targetEntitySet
      };
    }

    return createConverterContext(oConverterOutput, manifestSettings, templateType, shellServices, diagnostics, mergeFn, targetDataModelPath);
  }

  _exports.createConverterContextForMacro = createConverterContextForMacro;
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnZlcnRlckNvbnRleHQudHMiXSwibmFtZXMiOlsiaXNBbm5vdGF0aW9uVGVybSIsInZBbm5vdGF0aW9uUGF0aCIsImdldERhdGFNb2RlbFBhdGhGb3JFbnRpdHlTZXQiLCJlbnRpdHlTZXQiLCJkYXRhTW9kZWxQYXRoIiwic3RhcnRpbmdFbnRpdHlTZXQiLCJ0YXJnZXRFbnRpdHlUeXBlIiwiZW50aXR5VHlwZSIsInRhcmdldEVudGl0eVNldCIsIm5hdmlnYXRpb25Qcm9wZXJ0aWVzIiwiY29udGV4dExvY2F0aW9uIiwidW5kZWZpbmVkIiwidGFyZ2V0T2JqZWN0IiwiY3JlYXRlQ29udmVydGVyQ29udGV4dCIsIm9Db252ZXJ0ZWRUeXBlcyIsIm9NYW5pZmVzdFNldHRpbmdzIiwidGVtcGxhdGVUeXBlIiwic2hlbGxTZXJ2aWNlcyIsImRpYWdub3N0aWNzIiwibWVyZ2VGbiIsInRhcmdldERhdGFNb2RlbFBhdGgiLCJvTWFuaWZlc3RXcmFwcGVyIiwiY3JlYXRlTWFuaWZlc3RXcmFwcGVyIiwic0Jhc2VDb250ZXh0UGF0aCIsImdldFRhcmdldE9iamVjdFBhdGgiLCJnZXRFbnRpdHlUeXBlRnJvbUZ1bGx5UXVhbGlmaWVkTmFtZSIsImZ1bGx5UXVhbGlmaWVkTmFtZSIsImVudGl0eVR5cGVzIiwiZmluZCIsInN0YXJ0c1dpdGgiLCJyZXBsYWNlQW5ub3RhdGlvbiIsInJlcGxhY2UiLCJnZXRBbm5vdGF0aW9uRW50aXR5VHlwZSIsImFubm90YXRpb24iLCJhbm5vdGF0aW9uUGF0aCIsIkVycm9yIiwiZ2V0TWFuaWZlc3RDb250cm9sQ29uZmlndXJhdGlvbiIsImdldENvbnRyb2xDb25maWd1cmF0aW9uIiwiZ2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aCIsImdldEFic29sdXRlQW5ub3RhdGlvblBhdGgiLCJzQW5ub3RhdGlvblBhdGgiLCJnZXRFbnRpdHlTZXQiLCJnZXREYXRhTW9kZWxPYmplY3RQYXRoIiwiZmluZEVudGl0eVNldCIsImVudGl0eVNldE5hbWUiLCJlbnRpdHlTZXRzIiwibmFtZSIsImdldEVudGl0eVNldEZvckVudGl0eVR5cGUiLCJnZXRFbnRpdHlUeXBlIiwiZ2V0RW50aXR5UHJvcGVydHlGcm9tRnVsbHlRdWFsaWZpZWROYW1lIiwiZW50aXR5UHJvcGVydGllcyIsInByb3BlcnR5TmFtZSIsInNwbGl0IiwicG9wIiwiZ2V0RW50aXR5VHlwZUFubm90YXRpb24iLCJpbmRleE9mIiwicmVzb2x2ZVBhdGgiLCJyb290RW50aXR5U2V0IiwiY3VycmVudEVudGl0eVR5cGUiLCJjb25jYXQiLCJpIiwiY3VycmVudE9iamVjdCIsIm5hdmlnYXRlZFBhdGhzIiwidmlzaXRlZE9iamVjdHMiLCJsZW5ndGgiLCJfdHlwZSIsInB1c2giLCJ0YXJnZXRUeXBlIiwibmF2aWdhdGlvblByb3BlcnR5QmluZGluZyIsImhhc093blByb3BlcnR5Iiwiam9pbiIsIm91dERhdGFNb2RlbFBhdGgiLCJ0YXJnZXQiLCJjb252ZXJ0ZXJDb250ZXh0IiwiZ2V0VGVtcGxhdGVUeXBlIiwiZ2V0RW50aXR5U2V0QmFzZWRBbm5vdGF0aW9uUGF0aCIsImVudGl0eVR5cGVGUU4iLCJyZXBsYWNlZEFubm90YXRpb25QYXRoIiwic3Vic3RyIiwiZ2V0TWFuaWZlc3RXcmFwcGVyIiwiZ2V0U2hlbGxTZXJ2aWNlcyIsImdldERpYWdub3N0aWNzIiwiZ2V0Q29udmVydGVyQ29udGV4dEZvciIsInRhcmdldFBhdGgiLCJnZXRBbm5vdGF0aW9uQnlUeXBlIiwidm9jYWJ1bGFyeU5hbWUiLCJhbm5vdGF0aW9uVGVybSIsImFubm90YXRpb25zIiwib3V0QW5ub3RhdGlvbnMiLCJPYmplY3QiLCJrZXlzIiwiZmlsdGVyIiwidGVybSIsInJlZHVjZSIsInByZXZpb3VzVmFsdWUiLCJrZXkiLCJnZXRFbnRpdHlDb250YWluZXIiLCJlbnRpdHlDb250YWluZXIiLCJjcmVhdGVDb252ZXJ0ZXJDb250ZXh0Rm9yTWFjcm8iLCJzRW50aXR5U2V0TmFtZSIsIm9NZXRhTW9kZWxDb250ZXh0IiwibWFuaWZlc3RTZXR0aW5ncyIsIm9NZXRhTW9kZWwiLCJpc0EiLCJnZXRNb2RlbCIsIm9Db252ZXJ0ZXJPdXRwdXQiLCJjb252ZXJ0VHlwZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBdUJBOzs7Ozs7QUFNQSxNQUFNQSxnQkFBZ0IsR0FBRyxVQUFTQyxlQUFULEVBQWdHO0FBQ3hILFdBQU8sT0FBT0EsZUFBUCxLQUEyQixRQUFsQztBQUNBLEdBRkQ7O0FBSUEsTUFBTUMsNEJBQTRCLEdBQUcsVUFBU0MsU0FBVCxFQUFvRDtBQUN4RixRQUFNQyxhQUFrQyxHQUFHO0FBQzFDQyxNQUFBQSxpQkFBaUIsRUFBRUYsU0FEdUI7QUFFMUNHLE1BQUFBLGdCQUFnQixFQUFFSCxTQUFTLENBQUNJLFVBRmM7QUFHMUNDLE1BQUFBLGVBQWUsRUFBRUwsU0FIeUI7QUFJMUNNLE1BQUFBLG9CQUFvQixFQUFFLEVBSm9CO0FBSzFDQyxNQUFBQSxlQUFlLEVBQUVDLFNBTHlCO0FBTTFDQyxNQUFBQSxZQUFZLEVBQUVUO0FBTjRCLEtBQTNDO0FBUUFDLElBQUFBLGFBQWEsQ0FBQ00sZUFBZCxHQUFnQ04sYUFBaEM7QUFDQSxXQUFPQSxhQUFQO0FBQ0EsR0FYRDtBQWFBOzs7Ozs7Ozs7Ozs7Ozs7QUFhTyxXQUFTUyxzQkFBVCxDQUNOQyxlQURNLEVBRU5DLGlCQUZNLEVBR05DLFlBSE0sRUFJTkMsYUFKTSxFQUtOQyxXQUxNLEVBTU5DLE9BTk0sRUFPTkMsbUJBUE0sRUFRYTtBQUNuQixRQUFNQyxnQkFBZ0IsR0FBR0MscUJBQXFCLENBQUNQLGlCQUFELEVBQW9CSSxPQUFwQixDQUE5QztBQUNBLFFBQU1JLGdCQUFnQixHQUFHQyxtQkFBbUIsQ0FBQ0osbUJBQUQsQ0FBNUM7O0FBRUEsUUFBTUssbUNBQW1DLEdBQUcsVUFBU0Msa0JBQVQsRUFBNkQ7QUFDeEcsVUFBTXBCLGdCQUFnQixHQUFHUSxlQUFlLENBQUNhLFdBQWhCLENBQTRCQyxJQUE1QixDQUFpQyxVQUFBckIsVUFBVSxFQUFJO0FBQ3ZFLFlBQUltQixrQkFBa0IsQ0FBQ0csVUFBbkIsQ0FBOEJ0QixVQUFVLENBQUNtQixrQkFBekMsQ0FBSixFQUFrRTtBQUNqRSxjQUFNSSxpQkFBaUIsR0FBR0osa0JBQWtCLENBQUNLLE9BQW5CLENBQTJCeEIsVUFBVSxDQUFDbUIsa0JBQXRDLEVBQTBELEVBQTFELENBQTFCO0FBQ0EsaUJBQU9JLGlCQUFpQixDQUFDRCxVQUFsQixDQUE2QixHQUE3QixLQUFxQ0MsaUJBQWlCLENBQUNELFVBQWxCLENBQTZCLEdBQTdCLENBQTVDO0FBQ0E7O0FBQ0QsZUFBTyxLQUFQO0FBQ0EsT0FOd0IsQ0FBekI7QUFPQSxhQUFPdkIsZ0JBQVA7QUFDQSxLQVREOztBQVdBLFFBQU0wQix1QkFBdUIsR0FBRyxVQUFTQyxVQUFULEVBQXVEO0FBQ3RGLFVBQUlBLFVBQUosRUFBZ0I7QUFDZixZQUFNQyxjQUFjLEdBQUdELFVBQVUsQ0FBQ1Asa0JBQWxDO0FBQ0EsWUFBTXBCLGdCQUFnQixHQUFHbUIsbUNBQW1DLENBQUNTLGNBQUQsQ0FBNUQ7O0FBQ0EsWUFBSSxDQUFDNUIsZ0JBQUwsRUFBdUI7QUFDdEIsZ0JBQU0sSUFBSTZCLEtBQUosQ0FBVSxpQ0FBaUNGLFVBQVUsQ0FBQ1Asa0JBQXRELENBQU47QUFDQTs7QUFDRCxlQUFPcEIsZ0JBQVA7QUFDQSxPQVBELE1BT087QUFDTixlQUFPYyxtQkFBbUIsQ0FBQ2QsZ0JBQTNCO0FBQ0E7QUFDRCxLQVhEOztBQWFBLFFBQU04QiwrQkFBK0IsR0FBRyxVQUFTbkMsZUFBVCxFQUE2RDtBQUNwRyxVQUFJRCxnQkFBZ0IsQ0FBQ0MsZUFBRCxDQUFwQixFQUF1QztBQUN0QyxlQUFPb0IsZ0JBQWdCLENBQUNnQix1QkFBakIsQ0FDTkMseUJBQXlCLENBQUNyQyxlQUFlLENBQUN5QixrQkFBakIsRUFBcUNOLG1CQUFtQixDQUFDZCxnQkFBekQsQ0FEbkIsQ0FBUDtBQUdBOztBQUNELGFBQU9lLGdCQUFnQixDQUFDZ0IsdUJBQWpCLENBQXlDcEMsZUFBekMsQ0FBUDtBQUNBLEtBUEQ7O0FBU0EsUUFBTXNDLHlCQUF5QixHQUFHLFVBQVNDLGVBQVQsRUFBMEM7QUFDM0UsVUFBSSxDQUFDQSxlQUFMLEVBQXNCO0FBQ3JCLGVBQU9BLGVBQVA7QUFDQTs7QUFDRCxVQUFJQSxlQUFlLENBQUMsQ0FBRCxDQUFmLEtBQXVCLEdBQTNCLEVBQWdDO0FBQy9CLGVBQU9BLGVBQVA7QUFDQTs7QUFDRCxhQUFPakIsZ0JBQWdCLEdBQUcsR0FBbkIsR0FBeUJpQixlQUFoQztBQUNBLEtBUkQ7O0FBVUEsUUFBTUMsWUFBWSxHQUFHLFlBQWtDO0FBQ3RELGFBQU9yQixtQkFBbUIsQ0FBQ1osZUFBM0I7QUFDQSxLQUZEOztBQUlBLFFBQU1rQyxzQkFBc0IsR0FBRyxZQUFnQztBQUM5RCxhQUFPdEIsbUJBQVA7QUFDQSxLQUZEOztBQUlBLFFBQU11QixhQUFhLEdBQUcsVUFBU0MsYUFBVCxFQUFtRTtBQUN4RixVQUFJQSxhQUFhLEtBQUtqQyxTQUF0QixFQUFpQztBQUNoQyxlQUFPUyxtQkFBbUIsQ0FBQ1osZUFBM0I7QUFDQTs7QUFDRCxhQUFPTSxlQUFlLENBQUMrQixVQUFoQixDQUEyQmpCLElBQTNCLENBQWdDLFVBQUF6QixTQUFTO0FBQUEsZUFBSUEsU0FBUyxDQUFDMkMsSUFBVixLQUFtQkYsYUFBdkI7QUFBQSxPQUF6QyxDQUFQO0FBQ0EsS0FMRDs7QUFPQSxRQUFNRyx5QkFBeUIsR0FBRyxVQUFTeEMsVUFBVCxFQUF3RDtBQUN6RixhQUFPTyxlQUFlLENBQUMrQixVQUFoQixDQUEyQmpCLElBQTNCLENBQWdDLFVBQUF6QixTQUFTO0FBQUEsZUFBSUEsU0FBUyxDQUFDSSxVQUFWLEtBQXlCQSxVQUE3QjtBQUFBLE9BQXpDLENBQVA7QUFDQSxLQUZEOztBQUlBLFFBQU15QyxhQUFhLEdBQUcsWUFBdUI7QUFDNUMsYUFBTzVCLG1CQUFtQixDQUFDZCxnQkFBM0I7QUFDQSxLQUZEOztBQUlBLFFBQU0yQyx1Q0FBdUMsR0FBRyxVQUFTdkIsa0JBQVQsRUFBMkQ7QUFDMUcsVUFBSUEsa0JBQUosRUFBd0I7QUFBQTs7QUFDdkIsWUFBTXBCLGdCQUFnQixHQUFHbUIsbUNBQW1DLENBQUNDLGtCQUFELENBQTVEO0FBQ0EsZUFBT3BCLGdCQUFQLGFBQU9BLGdCQUFQLGdEQUFPQSxnQkFBZ0IsQ0FBRTRDLGdCQUF6QiwwREFBTyxzQkFBb0N0QixJQUFwQyxDQUNOLFVBQUN1QixZQUFEO0FBQUEsaUJBQXVCQSxZQUFZLENBQUNMLElBQWIsS0FBc0JwQixrQkFBa0IsQ0FBQzBCLEtBQW5CLENBQXlCLEdBQXpCLEVBQThCQyxHQUE5QixFQUE3QztBQUFBLFNBRE0sQ0FBUDtBQUdBOztBQUNELGFBQU8xQyxTQUFQO0FBQ0EsS0FSRDs7QUFVQSxRQUFNMkMsdUJBQXVCLEdBQUcsVUFBU3BCLGNBQVQsRUFBNEQ7QUFDM0YsVUFBSUEsY0FBYyxDQUFDcUIsT0FBZixDQUF1QixHQUF2QixNQUFnQyxDQUFDLENBQXJDLEVBQXdDO0FBQ3ZDckIsUUFBQUEsY0FBYyxHQUFHLE1BQU1BLGNBQXZCO0FBQ0E7O0FBQ0QsVUFBTXRCLFlBQTRCLEdBQUdRLG1CQUFtQixDQUFDZCxnQkFBcEIsQ0FBcUNrRCxXQUFyQyxDQUFpRHRCLGNBQWpELEVBQWlFLElBQWpFLENBQXJDO0FBRUEsVUFBSXVCLGFBQWEsR0FBR3JDLG1CQUFtQixDQUFDWixlQUF4QztBQUNBLFVBQUlrRCxpQkFBaUIsR0FBR3RDLG1CQUFtQixDQUFDZCxnQkFBNUM7QUFDQSxVQUFNRyxvQkFBb0IsR0FBR1csbUJBQW1CLENBQUNYLG9CQUFwQixDQUF5Q2tELE1BQXpDLEVBQTdCO0FBQ0EsVUFBSUMsQ0FBQyxHQUFHLENBQVI7QUFDQSxVQUFJQyxhQUFKO0FBQ0EsVUFBSUMsY0FBYyxHQUFHLEVBQXJCOztBQUNBLGFBQU9GLENBQUMsR0FBR2hELFlBQVksQ0FBQ21ELGNBQWIsQ0FBNEJDLE1BQXZDLEVBQStDO0FBQzlDSCxRQUFBQSxhQUFhLEdBQUdqRCxZQUFZLENBQUNtRCxjQUFiLENBQTRCSCxDQUFDLEVBQTdCLENBQWhCOztBQUNBLFlBQUlDLGFBQWEsQ0FBQ0ksS0FBZCxLQUF3QixvQkFBNUIsRUFBa0Q7QUFDakRILFVBQUFBLGNBQWMsQ0FBQ0ksSUFBZixDQUFvQkwsYUFBYSxDQUFDZixJQUFsQztBQUNBckMsVUFBQUEsb0JBQW9CLENBQUN5RCxJQUFyQixDQUEwQkwsYUFBMUI7QUFDQUgsVUFBQUEsaUJBQWlCLEdBQUlHLGFBQUQsQ0FBc0NNLFVBQTFEOztBQUNBLGNBQUlWLGFBQWEsSUFBSUEsYUFBYSxDQUFDVyx5QkFBZCxDQUF3Q0MsY0FBeEMsQ0FBdURQLGNBQWMsQ0FBQ1EsSUFBZixDQUFvQixHQUFwQixDQUF2RCxDQUFyQixFQUF1RztBQUN0R2IsWUFBQUEsYUFBYSxHQUFHQSxhQUFhLENBQUNXLHlCQUFkLENBQXdDUCxhQUFhLENBQUNmLElBQXRELENBQWhCO0FBQ0FnQixZQUFBQSxjQUFjLEdBQUcsRUFBakI7QUFDQTtBQUNEOztBQUNELFlBQUlELGFBQWEsQ0FBQ0ksS0FBZCxLQUF3QixXQUE1QixFQUF5QztBQUN4Q1IsVUFBQUEsYUFBYSxHQUFHSSxhQUFoQjtBQUNBSCxVQUFBQSxpQkFBaUIsR0FBR0QsYUFBYSxDQUFDbEQsVUFBbEM7QUFDQTtBQUNEOztBQUNELFVBQU1nRSxnQkFBZ0IsR0FBRztBQUN4QmxFLFFBQUFBLGlCQUFpQixFQUFFZSxtQkFBbUIsQ0FBQ2YsaUJBRGY7QUFFeEJHLFFBQUFBLGVBQWUsRUFBRWlELGFBRk87QUFHeEJuRCxRQUFBQSxnQkFBZ0IsRUFBRW9ELGlCQUhNO0FBSXhCOUMsUUFBQUEsWUFBWSxFQUFFSCxvQkFBb0IsQ0FBQ0Esb0JBQW9CLENBQUN1RCxNQUFyQixHQUE4QixDQUEvQixDQUpWO0FBS3hCdkQsUUFBQUEsb0JBQW9CLEVBQXBCQSxvQkFMd0I7QUFNeEJDLFFBQUFBLGVBQWUsRUFBRVUsbUJBQW1CLENBQUNWO0FBTmIsT0FBekI7QUFRQSxhQUFPO0FBQ051QixRQUFBQSxVQUFVLEVBQUVyQixZQUFZLENBQUM0RCxNQURuQjtBQUVOQyxRQUFBQSxnQkFBZ0IsRUFBRTVELHNCQUFzQixDQUN2Q0MsZUFEdUMsRUFFdkNDLGlCQUZ1QyxFQUd2Q0MsWUFIdUMsRUFJdkNDLGFBSnVDLEVBS3ZDQyxXQUx1QyxFQU12Q0MsT0FOdUMsRUFPdkNvRCxnQkFQdUM7QUFGbEMsT0FBUDtBQVlBLEtBaEREOztBQWtEQSxRQUFNRyxlQUFlLEdBQUcsWUFBeUI7QUFDaEQsYUFBTzFELFlBQVA7QUFDQSxLQUZEOztBQUlBLFFBQU1zQix5QkFBeUIsR0FBRyxVQUFTSixjQUFULEVBQWlDM0IsVUFBakMsRUFBaUU7QUFDbEcsYUFBTzJCLGNBQWMsQ0FBQ0gsT0FBZixDQUF1QnhCLFVBQVUsQ0FBQ21CLGtCQUFsQyxFQUFzRCxFQUF0RCxDQUFQO0FBQ0EsS0FGRDs7QUFJQSxRQUFNaUQsK0JBQStCLEdBQUcsVUFBU3pDLGNBQVQsRUFBeUM7QUFDaEYsVUFBSSxDQUFDQSxjQUFMLEVBQXFCO0FBQ3BCLGVBQU9BLGNBQVA7QUFDQTs7QUFDRCxVQUFNMEMsYUFBYSxHQUFHeEQsbUJBQW1CLENBQUNkLGdCQUFwQixDQUFxQ29CLGtCQUEzRDs7QUFDQSxVQUFJTixtQkFBbUIsQ0FBQ1osZUFBeEIsRUFBeUM7QUFDeEMsWUFBSXFFLHNCQUFzQixHQUFHM0MsY0FBYyxDQUFDSCxPQUFmLENBQXVCNkMsYUFBdkIsRUFBc0MsR0FBdEMsQ0FBN0I7O0FBQ0EsWUFBSUMsc0JBQXNCLENBQUNiLE1BQXZCLEdBQWdDLENBQWhDLElBQXFDYSxzQkFBc0IsQ0FBQyxDQUFELENBQXRCLEtBQThCLEdBQW5FLElBQTBFQSxzQkFBc0IsQ0FBQyxDQUFELENBQXRCLEtBQThCLEdBQTVHLEVBQWlIO0FBQ2hIQSxVQUFBQSxzQkFBc0IsR0FBR0Esc0JBQXNCLENBQUNDLE1BQXZCLENBQThCLENBQTlCLENBQXpCO0FBQ0E7O0FBQ0QsZUFBT3ZELGdCQUFnQixHQUFHc0Qsc0JBQTFCO0FBQ0EsT0FORCxNQU1PO0FBQ04sZUFBTyxNQUFNM0MsY0FBYjtBQUNBO0FBQ0QsS0FkRDs7QUFnQkEsUUFBTTZDLGtCQUFrQixHQUFHLFlBQTRCO0FBQ3RELGFBQU8xRCxnQkFBUDtBQUNBLEtBRkQ7O0FBSUEsUUFBTTJELGdCQUFnQixHQUFHLFlBQWdDO0FBQ3hELGFBQU8vRCxhQUFQO0FBQ0EsS0FGRDs7QUFJQSxRQUFNZ0UsY0FBYyxHQUFHLFlBQXlCO0FBQy9DLGFBQU8vRCxXQUFQO0FBQ0EsS0FGRDs7QUFJQSxRQUFNZ0Usc0JBQXNCLEdBQUcsVUFBUzFFLGVBQVQsRUFBdUQ7QUFDckYsVUFBTTJFLFVBQVUsR0FBR2pGLDRCQUE0QixDQUFDTSxlQUFELENBQS9DO0FBQ0EsYUFBT0ssc0JBQXNCLENBQUNDLGVBQUQsRUFBa0JDLGlCQUFsQixFQUFxQ0MsWUFBckMsRUFBbURDLGFBQW5ELEVBQWtFQyxXQUFsRSxFQUErRUMsT0FBL0UsRUFBd0ZnRSxVQUF4RixDQUE3QjtBQUNBLEtBSEQ7O0FBS0EsUUFBTUMsbUJBQW1CLEdBQUcsVUFDM0JDLGNBRDJCLEVBRTNCQyxjQUYyQixFQUlIO0FBQUEsVUFEeEIvRSxVQUN3Qix1RUFEQ3lDLGFBQWEsRUFDZDtBQUN4QixVQUFNdUMsV0FBZ0QsR0FBRyxDQUFBaEYsVUFBVSxTQUFWLElBQUFBLFVBQVUsV0FBVixZQUFBQSxVQUFVLENBQUVnRixXQUFaLENBQXdCRixjQUF4QixNQUEyQyxFQUFwRztBQUNBLFVBQUlHLGNBQW1DLEdBQUcsRUFBMUM7O0FBQ0EsVUFBSUQsV0FBSixFQUFpQjtBQUNoQkMsUUFBQUEsY0FBYyxHQUFHQyxNQUFNLENBQUNDLElBQVAsQ0FBWUgsV0FBWixFQUNmSSxNQURlLENBQ1IsVUFBQTFELFVBQVU7QUFBQSxpQkFBSXNELFdBQVcsQ0FBQ3RELFVBQUQsQ0FBWCxDQUF3QjJELElBQXhCLEtBQWlDTixjQUFyQztBQUFBLFNBREYsRUFFZk8sTUFGZSxDQUVSLFVBQUNDLGFBQUQsRUFBdUNDLEdBQXZDLEVBQXVEO0FBQzlERCxVQUFBQSxhQUFhLENBQUM1QixJQUFkLENBQW1CcUIsV0FBVyxDQUFDUSxHQUFELENBQTlCO0FBQ0EsaUJBQU9ELGFBQVA7QUFDQSxTQUxlLEVBS2IsRUFMYSxDQUFqQjtBQU1BOztBQUNELGFBQU9OLGNBQVA7QUFDQSxLQWhCRDs7QUFrQkEsUUFBTVEsa0JBQWtCLEdBQUcsWUFBNEI7QUFDdEQsYUFBT2xGLGVBQWUsQ0FBQ21GLGVBQXZCO0FBQ0EsS0FGRDs7QUFJQSxXQUFPO0FBQ05qRSxNQUFBQSx1QkFBdUIsRUFBdkJBLHVCQURNO0FBRU5JLE1BQUFBLCtCQUErQixFQUEvQkEsK0JBRk07QUFHTkcsTUFBQUEseUJBQXlCLEVBQXpCQSx5QkFITTtBQUlORSxNQUFBQSxZQUFZLEVBQVpBLFlBSk07QUFLTkMsTUFBQUEsc0JBQXNCLEVBQXRCQSxzQkFMTTtBQU1OQyxNQUFBQSxhQUFhLEVBQWJBLGFBTk07QUFPTkksTUFBQUEseUJBQXlCLEVBQXpCQSx5QkFQTTtBQVFOQyxNQUFBQSxhQUFhLEVBQWJBLGFBUk07QUFTTk0sTUFBQUEsdUJBQXVCLEVBQXZCQSx1QkFUTTtBQVVOb0IsTUFBQUEsZUFBZSxFQUFmQSxlQVZNO0FBV05wQyxNQUFBQSx5QkFBeUIsRUFBekJBLHlCQVhNO0FBWU5xQyxNQUFBQSwrQkFBK0IsRUFBL0JBLCtCQVpNO0FBYU5JLE1BQUFBLGtCQUFrQixFQUFsQkEsa0JBYk07QUFjTkMsTUFBQUEsZ0JBQWdCLEVBQWhCQSxnQkFkTTtBQWVOQyxNQUFBQSxjQUFjLEVBQWRBLGNBZk07QUFnQk5DLE1BQUFBLHNCQUFzQixFQUF0QkEsc0JBaEJNO0FBaUJOakMsTUFBQUEsdUNBQXVDLEVBQXZDQSx1Q0FqQk07QUFrQk5tQyxNQUFBQSxtQkFBbUIsRUFBbkJBLG1CQWxCTTtBQW1CTlksTUFBQUEsa0JBQWtCLEVBQWxCQTtBQW5CTSxLQUFQO0FBcUJBO0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUFZTyxXQUFTRSw4QkFBVCxDQUNOQyxjQURNLEVBRU5DLGlCQUZNLEVBR05wRixZQUhNLEVBSU5DLGFBSk0sRUFLTkMsV0FMTSxFQU1OQyxPQU5NLEVBT05DLG1CQVBNLEVBU2E7QUFBQSxRQURuQmlGLGdCQUNtQix1RUFEc0IsRUFDdEI7QUFDbkIsUUFBTUMsVUFBMEIsR0FBR0YsaUJBQWlCLENBQUNHLEdBQWxCLENBQXNCLHNDQUF0QixJQUMvQkgsaUJBRCtCLEdBRTdCQSxpQkFBRCxDQUErQkksUUFBL0IsRUFGTDtBQUdBLFFBQU1DLGdCQUFnQixHQUFHQyxZQUFZLENBQUNKLFVBQUQsQ0FBckM7QUFDQSxRQUFNOUYsZUFBZSxHQUFHaUcsZ0JBQWdCLENBQUM1RCxVQUFqQixDQUE0QmpCLElBQTVCLENBQWlDLFVBQUF6QixTQUFTO0FBQUEsYUFBSUEsU0FBUyxDQUFDMkMsSUFBVixLQUFtQnFELGNBQXZCO0FBQUEsS0FBMUMsQ0FBeEI7O0FBQ0EsUUFBSSxDQUFDL0UsbUJBQUwsRUFBMEI7QUFDekJBLE1BQUFBLG1CQUFtQixHQUFHO0FBQ3JCZixRQUFBQSxpQkFBaUIsRUFBRUcsZUFERTtBQUVyQkMsUUFBQUEsb0JBQW9CLEVBQUUsRUFGRDtBQUdyQkQsUUFBQUEsZUFBZSxFQUFFQSxlQUhJO0FBSXJCRixRQUFBQSxnQkFBZ0IsRUFBRUUsZUFBZSxDQUFDRCxVQUpiO0FBS3JCSyxRQUFBQSxZQUFZLEVBQUVKO0FBTE8sT0FBdEI7QUFPQTs7QUFDRCxXQUFPSyxzQkFBc0IsQ0FDNUI0RixnQkFENEIsRUFFNUJKLGdCQUY0QixFQUc1QnJGLFlBSDRCLEVBSTVCQyxhQUo0QixFQUs1QkMsV0FMNEIsRUFNNUJDLE9BTjRCLEVBTzVCQyxtQkFQNEIsQ0FBN0I7QUFTQSIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQW5ub3RhdGlvblRlcm0gfSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXNcIjtcbmltcG9ydCB7XG5cdEFueUFubm90YXRpb24sXG5cdENvbnZlcnRlck91dHB1dCxcblx0RW50aXR5U2V0LFxuXHRFbnRpdHlUeXBlLFxuXHRFbnRpdHlDb250YWluZXIsXG5cdE5hdmlnYXRpb25Qcm9wZXJ0eSxcblx0UHJvcGVydHlcbn0gZnJvbSBcIkBzYXAtdXgvYW5ub3RhdGlvbi1jb252ZXJ0ZXJcIjtcbmltcG9ydCB7IEJhc2VNYW5pZmVzdFNldHRpbmdzLCBjcmVhdGVNYW5pZmVzdFdyYXBwZXIsIE1hbmlmZXN0V3JhcHBlciB9IGZyb20gXCJzYXAvZmUvY29yZS9jb252ZXJ0ZXJzL01hbmlmZXN0U2V0dGluZ3NcIjtcbmltcG9ydCB7XG5cdENvbnZlcnRlckNvbnRleHQsXG5cdElTaGVsbFNlcnZpY2VzUHJveHksXG5cdFRlbXBsYXRlVHlwZSxcblx0UmVzb2x2ZWRBbm5vdGF0aW9uQ29udGV4dFxufSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy90ZW1wbGF0ZXMvQmFzZUNvbnZlcnRlclwiO1xuaW1wb3J0IHsgQ29udGV4dCwgT0RhdGFNZXRhTW9kZWwgfSBmcm9tIFwic2FwL3VpL21vZGVsL29kYXRhL3Y0XCI7XG5pbXBvcnQgeyBjb252ZXJ0VHlwZXMsIFJlc29sdmVkVGFyZ2V0IH0gZnJvbSBcInNhcC9mZS9jb3JlL2NvbnZlcnRlcnMvTWV0YU1vZGVsQ29udmVydGVyXCI7XG5pbXBvcnQgeyBJRGlhZ25vc3RpY3MgfSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy9UZW1wbGF0ZUNvbnZlcnRlclwiO1xuaW1wb3J0IHsgRGF0YU1vZGVsT2JqZWN0UGF0aCwgZ2V0VGFyZ2V0T2JqZWN0UGF0aCB9IGZyb20gXCJzYXAvZmUvY29yZS90ZW1wbGF0aW5nL0RhdGFNb2RlbFBhdGhIZWxwZXJcIjtcbmltcG9ydCB7IEVudGl0eVR5cGVBbm5vdGF0aW9ucyB9IGZyb20gXCJAc2FwLXV4L3ZvY2FidWxhcmllcy10eXBlcy90eXBlcy9nZW5lcmF0ZWQvRWRtX1R5cGVzXCI7XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGlzIGFuIGFubm90YXRpb24gdGVybS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xBbm5vdGF0aW9uVGVybTxvYmplY3Q+fSB2QW5ub3RhdGlvblBhdGhcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5jb25zdCBpc0Fubm90YXRpb25UZXJtID0gZnVuY3Rpb24odkFubm90YXRpb25QYXRoOiBzdHJpbmcgfCBBbm5vdGF0aW9uVGVybTxhbnk+KTogdkFubm90YXRpb25QYXRoIGlzIEFubm90YXRpb25UZXJtPGFueT4ge1xuXHRyZXR1cm4gdHlwZW9mIHZBbm5vdGF0aW9uUGF0aCA9PT0gXCJvYmplY3RcIjtcbn07XG5cbmNvbnN0IGdldERhdGFNb2RlbFBhdGhGb3JFbnRpdHlTZXQgPSBmdW5jdGlvbihlbnRpdHlTZXQ6IEVudGl0eVNldCk6IERhdGFNb2RlbE9iamVjdFBhdGgge1xuXHRjb25zdCBkYXRhTW9kZWxQYXRoOiBEYXRhTW9kZWxPYmplY3RQYXRoID0ge1xuXHRcdHN0YXJ0aW5nRW50aXR5U2V0OiBlbnRpdHlTZXQsXG5cdFx0dGFyZ2V0RW50aXR5VHlwZTogZW50aXR5U2V0LmVudGl0eVR5cGUsXG5cdFx0dGFyZ2V0RW50aXR5U2V0OiBlbnRpdHlTZXQsXG5cdFx0bmF2aWdhdGlvblByb3BlcnRpZXM6IFtdLFxuXHRcdGNvbnRleHRMb2NhdGlvbjogdW5kZWZpbmVkLFxuXHRcdHRhcmdldE9iamVjdDogZW50aXR5U2V0XG5cdH07XG5cdGRhdGFNb2RlbFBhdGguY29udGV4dExvY2F0aW9uID0gZGF0YU1vZGVsUGF0aDtcblx0cmV0dXJuIGRhdGFNb2RlbFBhdGg7XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIENvbnZlcnRlckNvbnRleHQgb2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkIHdpdGhpbiB0aGUgY29udmVydGVycy5cbiAqXG4gKiBAcGFyYW0ge0NvbnZlcnRlck91dHB1dH0gb0NvbnZlcnRlZFR5cGVzIHRoZSBjb252ZXJ0ZWQgYW5ub3RhdGlvbiBhbmQgc2VydmljZSB0eXBlc1xuICogQHBhcmFtIHtCYXNlTWFuaWZlc3RTZXR0aW5nc30gb01hbmlmZXN0U2V0dGluZ3MgdGhlIG1hbmlmZXN0U2V0dGluZ3MgdGhhdCBhcHBsaWVzIHRvIHRoaXMgcGFnZVxuICogQHBhcmFtIHtUZW1wbGF0ZVR5cGV9IHRlbXBsYXRlVHlwZSB0aGUgdHlwZSBvZiB0ZW1wbGF0ZSB3ZSdyZSBsb29raW5nIGF0IHJpZ2h0IG5vd1xuICogQHBhcmFtIHtJU2hlbGxTZXJ2aWNlc1Byb3h5fSBzaGVsbFNlcnZpY2VzIHRoZSBjdXJyZW50IGluc3RhbmNlIG9mIHRoZSBzaGVsbHNlcnZpY2VcbiAqIEBwYXJhbSB7SURpYWdub3N0aWNzfSBkaWFnbm9zdGljcyB0aGUgZGlhZ25vc3RpY3Mgc2hpbVxuICogQHBhcmFtIHtGdW5jdGlvbn0gbWVyZ2VGbiB0aGUgZnVuY3Rpb24gdG8gYmUgdXNlZCB0byBwZXJmb20gc29tZSBkZWVwIG1lcmdlcyBiZXR3ZWVuIG9iamVjdFxuICogQHBhcmFtIHtEYXRhTW9kZWxPYmplY3RQYXRofSB0YXJnZXREYXRhTW9kZWxQYXRoIHRoZSBnbG9iYWwgcGF0aCB0byByZWFjaCB0aGUgZW50aXR5U2V0XG4gKlxuICogQHJldHVybnMge0NvbnZlcnRlckNvbnRleHR9IGEgY29udmVydGVyIGNvbnRleHQgZm9yIHRoZSBjb252ZXJ0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDb252ZXJ0ZXJDb250ZXh0KFxuXHRvQ29udmVydGVkVHlwZXM6IENvbnZlcnRlck91dHB1dCxcblx0b01hbmlmZXN0U2V0dGluZ3M6IEJhc2VNYW5pZmVzdFNldHRpbmdzLFxuXHR0ZW1wbGF0ZVR5cGU6IFRlbXBsYXRlVHlwZSxcblx0c2hlbGxTZXJ2aWNlczogSVNoZWxsU2VydmljZXNQcm94eSxcblx0ZGlhZ25vc3RpY3M6IElEaWFnbm9zdGljcyxcblx0bWVyZ2VGbjogRnVuY3Rpb24sXG5cdHRhcmdldERhdGFNb2RlbFBhdGg6IERhdGFNb2RlbE9iamVjdFBhdGhcbik6IENvbnZlcnRlckNvbnRleHQge1xuXHRjb25zdCBvTWFuaWZlc3RXcmFwcGVyID0gY3JlYXRlTWFuaWZlc3RXcmFwcGVyKG9NYW5pZmVzdFNldHRpbmdzLCBtZXJnZUZuKTtcblx0Y29uc3Qgc0Jhc2VDb250ZXh0UGF0aCA9IGdldFRhcmdldE9iamVjdFBhdGgodGFyZ2V0RGF0YU1vZGVsUGF0aCk7XG5cblx0Y29uc3QgZ2V0RW50aXR5VHlwZUZyb21GdWxseVF1YWxpZmllZE5hbWUgPSBmdW5jdGlvbihmdWxseVF1YWxpZmllZE5hbWU6IHN0cmluZyk6IEVudGl0eVR5cGUgfCB1bmRlZmluZWQge1xuXHRcdGNvbnN0IHRhcmdldEVudGl0eVR5cGUgPSBvQ29udmVydGVkVHlwZXMuZW50aXR5VHlwZXMuZmluZChlbnRpdHlUeXBlID0+IHtcblx0XHRcdGlmIChmdWxseVF1YWxpZmllZE5hbWUuc3RhcnRzV2l0aChlbnRpdHlUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZSkpIHtcblx0XHRcdFx0Y29uc3QgcmVwbGFjZUFubm90YXRpb24gPSBmdWxseVF1YWxpZmllZE5hbWUucmVwbGFjZShlbnRpdHlUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZSwgXCJcIik7XG5cdFx0XHRcdHJldHVybiByZXBsYWNlQW5ub3RhdGlvbi5zdGFydHNXaXRoKFwiL1wiKSB8fCByZXBsYWNlQW5ub3RhdGlvbi5zdGFydHNXaXRoKFwiQFwiKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdGFyZ2V0RW50aXR5VHlwZTtcblx0fTtcblxuXHRjb25zdCBnZXRBbm5vdGF0aW9uRW50aXR5VHlwZSA9IGZ1bmN0aW9uKGFubm90YXRpb24/OiBBbm5vdGF0aW9uVGVybTxhbnk+KTogRW50aXR5VHlwZSB7XG5cdFx0aWYgKGFubm90YXRpb24pIHtcblx0XHRcdGNvbnN0IGFubm90YXRpb25QYXRoID0gYW5ub3RhdGlvbi5mdWxseVF1YWxpZmllZE5hbWU7XG5cdFx0XHRjb25zdCB0YXJnZXRFbnRpdHlUeXBlID0gZ2V0RW50aXR5VHlwZUZyb21GdWxseVF1YWxpZmllZE5hbWUoYW5ub3RhdGlvblBhdGgpO1xuXHRcdFx0aWYgKCF0YXJnZXRFbnRpdHlUeXBlKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIEVudGl0eSBUeXBlIGZvciBcIiArIGFubm90YXRpb24uZnVsbHlRdWFsaWZpZWROYW1lKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0YXJnZXRFbnRpdHlUeXBlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGFyZ2V0RGF0YU1vZGVsUGF0aC50YXJnZXRFbnRpdHlUeXBlO1xuXHRcdH1cblx0fTtcblxuXHRjb25zdCBnZXRNYW5pZmVzdENvbnRyb2xDb25maWd1cmF0aW9uID0gZnVuY3Rpb24odkFubm90YXRpb25QYXRoOiBzdHJpbmcgfCBBbm5vdGF0aW9uVGVybTxhbnk+KTogYW55IHtcblx0XHRpZiAoaXNBbm5vdGF0aW9uVGVybSh2QW5ub3RhdGlvblBhdGgpKSB7XG5cdFx0XHRyZXR1cm4gb01hbmlmZXN0V3JhcHBlci5nZXRDb250cm9sQ29uZmlndXJhdGlvbihcblx0XHRcdFx0Z2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aCh2QW5ub3RhdGlvblBhdGguZnVsbHlRdWFsaWZpZWROYW1lLCB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVR5cGUpXG5cdFx0XHQpO1xuXHRcdH1cblx0XHRyZXR1cm4gb01hbmlmZXN0V3JhcHBlci5nZXRDb250cm9sQ29uZmlndXJhdGlvbih2QW5ub3RhdGlvblBhdGgpO1xuXHR9O1xuXG5cdGNvbnN0IGdldEFic29sdXRlQW5ub3RhdGlvblBhdGggPSBmdW5jdGlvbihzQW5ub3RhdGlvblBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKCFzQW5ub3RhdGlvblBhdGgpIHtcblx0XHRcdHJldHVybiBzQW5ub3RhdGlvblBhdGg7XG5cdFx0fVxuXHRcdGlmIChzQW5ub3RhdGlvblBhdGhbMF0gPT09IFwiL1wiKSB7XG5cdFx0XHRyZXR1cm4gc0Fubm90YXRpb25QYXRoO1xuXHRcdH1cblx0XHRyZXR1cm4gc0Jhc2VDb250ZXh0UGF0aCArIFwiL1wiICsgc0Fubm90YXRpb25QYXRoO1xuXHR9O1xuXG5cdGNvbnN0IGdldEVudGl0eVNldCA9IGZ1bmN0aW9uKCk6IEVudGl0eVNldCB8IHVuZGVmaW5lZCB7XG5cdFx0cmV0dXJuIHRhcmdldERhdGFNb2RlbFBhdGgudGFyZ2V0RW50aXR5U2V0O1xuXHR9O1xuXG5cdGNvbnN0IGdldERhdGFNb2RlbE9iamVjdFBhdGggPSBmdW5jdGlvbigpOiBEYXRhTW9kZWxPYmplY3RQYXRoIHtcblx0XHRyZXR1cm4gdGFyZ2V0RGF0YU1vZGVsUGF0aDtcblx0fTtcblxuXHRjb25zdCBmaW5kRW50aXR5U2V0ID0gZnVuY3Rpb24oZW50aXR5U2V0TmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkKTogRW50aXR5U2V0IHwgdW5kZWZpbmVkIHtcblx0XHRpZiAoZW50aXR5U2V0TmFtZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRyZXR1cm4gdGFyZ2V0RGF0YU1vZGVsUGF0aC50YXJnZXRFbnRpdHlTZXQ7XG5cdFx0fVxuXHRcdHJldHVybiBvQ29udmVydGVkVHlwZXMuZW50aXR5U2V0cy5maW5kKGVudGl0eVNldCA9PiBlbnRpdHlTZXQubmFtZSA9PT0gZW50aXR5U2V0TmFtZSk7XG5cdH07XG5cblx0Y29uc3QgZ2V0RW50aXR5U2V0Rm9yRW50aXR5VHlwZSA9IGZ1bmN0aW9uKGVudGl0eVR5cGU6IEVudGl0eVR5cGUpOiBFbnRpdHlTZXQgfCB1bmRlZmluZWQge1xuXHRcdHJldHVybiBvQ29udmVydGVkVHlwZXMuZW50aXR5U2V0cy5maW5kKGVudGl0eVNldCA9PiBlbnRpdHlTZXQuZW50aXR5VHlwZSA9PT0gZW50aXR5VHlwZSk7XG5cdH07XG5cblx0Y29uc3QgZ2V0RW50aXR5VHlwZSA9IGZ1bmN0aW9uKCk6IEVudGl0eVR5cGUge1xuXHRcdHJldHVybiB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVR5cGU7XG5cdH07XG5cblx0Y29uc3QgZ2V0RW50aXR5UHJvcGVydHlGcm9tRnVsbHlRdWFsaWZpZWROYW1lID0gZnVuY3Rpb24oZnVsbHlRdWFsaWZpZWROYW1lOiBzdHJpbmcpOiBQcm9wZXJ0eSB8IHVuZGVmaW5lZCB7XG5cdFx0aWYgKGZ1bGx5UXVhbGlmaWVkTmFtZSkge1xuXHRcdFx0Y29uc3QgdGFyZ2V0RW50aXR5VHlwZSA9IGdldEVudGl0eVR5cGVGcm9tRnVsbHlRdWFsaWZpZWROYW1lKGZ1bGx5UXVhbGlmaWVkTmFtZSk7XG5cdFx0XHRyZXR1cm4gdGFyZ2V0RW50aXR5VHlwZT8uZW50aXR5UHJvcGVydGllcz8uZmluZChcblx0XHRcdFx0KHByb3BlcnR5TmFtZTogYW55KSA9PiBwcm9wZXJ0eU5hbWUubmFtZSA9PT0gZnVsbHlRdWFsaWZpZWROYW1lLnNwbGl0KFwiL1wiKS5wb3AoKVxuXHRcdFx0KSBhcyBQcm9wZXJ0eTtcblx0XHR9XG5cdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0fTtcblxuXHRjb25zdCBnZXRFbnRpdHlUeXBlQW5ub3RhdGlvbiA9IGZ1bmN0aW9uKGFubm90YXRpb25QYXRoOiBzdHJpbmcpOiBSZXNvbHZlZEFubm90YXRpb25Db250ZXh0IHtcblx0XHRpZiAoYW5ub3RhdGlvblBhdGguaW5kZXhPZihcIkBcIikgPT09IC0xKSB7XG5cdFx0XHRhbm5vdGF0aW9uUGF0aCA9IFwiQFwiICsgYW5ub3RhdGlvblBhdGg7XG5cdFx0fVxuXHRcdGNvbnN0IHRhcmdldE9iamVjdDogUmVzb2x2ZWRUYXJnZXQgPSB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVR5cGUucmVzb2x2ZVBhdGgoYW5ub3RhdGlvblBhdGgsIHRydWUpO1xuXG5cdFx0bGV0IHJvb3RFbnRpdHlTZXQgPSB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVNldDtcblx0XHRsZXQgY3VycmVudEVudGl0eVR5cGUgPSB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVR5cGU7XG5cdFx0Y29uc3QgbmF2aWdhdGlvblByb3BlcnRpZXMgPSB0YXJnZXREYXRhTW9kZWxQYXRoLm5hdmlnYXRpb25Qcm9wZXJ0aWVzLmNvbmNhdCgpO1xuXHRcdGxldCBpID0gMTtcblx0XHRsZXQgY3VycmVudE9iamVjdDtcblx0XHRsZXQgbmF2aWdhdGVkUGF0aHMgPSBbXTtcblx0XHR3aGlsZSAoaSA8IHRhcmdldE9iamVjdC52aXNpdGVkT2JqZWN0cy5sZW5ndGgpIHtcblx0XHRcdGN1cnJlbnRPYmplY3QgPSB0YXJnZXRPYmplY3QudmlzaXRlZE9iamVjdHNbaSsrXTtcblx0XHRcdGlmIChjdXJyZW50T2JqZWN0Ll90eXBlID09PSBcIk5hdmlnYXRpb25Qcm9wZXJ0eVwiKSB7XG5cdFx0XHRcdG5hdmlnYXRlZFBhdGhzLnB1c2goY3VycmVudE9iamVjdC5uYW1lKTtcblx0XHRcdFx0bmF2aWdhdGlvblByb3BlcnRpZXMucHVzaChjdXJyZW50T2JqZWN0IGFzIE5hdmlnYXRpb25Qcm9wZXJ0eSk7XG5cdFx0XHRcdGN1cnJlbnRFbnRpdHlUeXBlID0gKGN1cnJlbnRPYmplY3QgYXMgTmF2aWdhdGlvblByb3BlcnR5KS50YXJnZXRUeXBlO1xuXHRcdFx0XHRpZiAocm9vdEVudGl0eVNldCAmJiByb290RW50aXR5U2V0Lm5hdmlnYXRpb25Qcm9wZXJ0eUJpbmRpbmcuaGFzT3duUHJvcGVydHkobmF2aWdhdGVkUGF0aHMuam9pbihcIi9cIikpKSB7XG5cdFx0XHRcdFx0cm9vdEVudGl0eVNldCA9IHJvb3RFbnRpdHlTZXQubmF2aWdhdGlvblByb3BlcnR5QmluZGluZ1tjdXJyZW50T2JqZWN0Lm5hbWVdO1xuXHRcdFx0XHRcdG5hdmlnYXRlZFBhdGhzID0gW107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChjdXJyZW50T2JqZWN0Ll90eXBlID09PSBcIkVudGl0eVNldFwiKSB7XG5cdFx0XHRcdHJvb3RFbnRpdHlTZXQgPSBjdXJyZW50T2JqZWN0IGFzIEVudGl0eVNldDtcblx0XHRcdFx0Y3VycmVudEVudGl0eVR5cGUgPSByb290RW50aXR5U2V0LmVudGl0eVR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGNvbnN0IG91dERhdGFNb2RlbFBhdGggPSB7XG5cdFx0XHRzdGFydGluZ0VudGl0eVNldDogdGFyZ2V0RGF0YU1vZGVsUGF0aC5zdGFydGluZ0VudGl0eVNldCxcblx0XHRcdHRhcmdldEVudGl0eVNldDogcm9vdEVudGl0eVNldCxcblx0XHRcdHRhcmdldEVudGl0eVR5cGU6IGN1cnJlbnRFbnRpdHlUeXBlLFxuXHRcdFx0dGFyZ2V0T2JqZWN0OiBuYXZpZ2F0aW9uUHJvcGVydGllc1tuYXZpZ2F0aW9uUHJvcGVydGllcy5sZW5ndGggLSAxXSxcblx0XHRcdG5hdmlnYXRpb25Qcm9wZXJ0aWVzLFxuXHRcdFx0Y29udGV4dExvY2F0aW9uOiB0YXJnZXREYXRhTW9kZWxQYXRoLmNvbnRleHRMb2NhdGlvblxuXHRcdH07XG5cdFx0cmV0dXJuIHtcblx0XHRcdGFubm90YXRpb246IHRhcmdldE9iamVjdC50YXJnZXQgYXMgQW55QW5ub3RhdGlvbixcblx0XHRcdGNvbnZlcnRlckNvbnRleHQ6IGNyZWF0ZUNvbnZlcnRlckNvbnRleHQoXG5cdFx0XHRcdG9Db252ZXJ0ZWRUeXBlcyxcblx0XHRcdFx0b01hbmlmZXN0U2V0dGluZ3MsXG5cdFx0XHRcdHRlbXBsYXRlVHlwZSxcblx0XHRcdFx0c2hlbGxTZXJ2aWNlcyxcblx0XHRcdFx0ZGlhZ25vc3RpY3MsXG5cdFx0XHRcdG1lcmdlRm4sXG5cdFx0XHRcdG91dERhdGFNb2RlbFBhdGhcblx0XHRcdClcblx0XHR9O1xuXHR9O1xuXG5cdGNvbnN0IGdldFRlbXBsYXRlVHlwZSA9IGZ1bmN0aW9uKCk6IFRlbXBsYXRlVHlwZSB7XG5cdFx0cmV0dXJuIHRlbXBsYXRlVHlwZTtcblx0fTtcblxuXHRjb25zdCBnZXRSZWxhdGl2ZUFubm90YXRpb25QYXRoID0gZnVuY3Rpb24oYW5ub3RhdGlvblBhdGg6IHN0cmluZywgZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGFubm90YXRpb25QYXRoLnJlcGxhY2UoZW50aXR5VHlwZS5mdWxseVF1YWxpZmllZE5hbWUsIFwiXCIpO1xuXHR9O1xuXG5cdGNvbnN0IGdldEVudGl0eVNldEJhc2VkQW5ub3RhdGlvblBhdGggPSBmdW5jdGlvbihhbm5vdGF0aW9uUGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAoIWFubm90YXRpb25QYXRoKSB7XG5cdFx0XHRyZXR1cm4gYW5ub3RhdGlvblBhdGg7XG5cdFx0fVxuXHRcdGNvbnN0IGVudGl0eVR5cGVGUU4gPSB0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVR5cGUuZnVsbHlRdWFsaWZpZWROYW1lO1xuXHRcdGlmICh0YXJnZXREYXRhTW9kZWxQYXRoLnRhcmdldEVudGl0eVNldCkge1xuXHRcdFx0bGV0IHJlcGxhY2VkQW5ub3RhdGlvblBhdGggPSBhbm5vdGF0aW9uUGF0aC5yZXBsYWNlKGVudGl0eVR5cGVGUU4sIFwiL1wiKTtcblx0XHRcdGlmIChyZXBsYWNlZEFubm90YXRpb25QYXRoLmxlbmd0aCA+IDIgJiYgcmVwbGFjZWRBbm5vdGF0aW9uUGF0aFswXSA9PT0gXCIvXCIgJiYgcmVwbGFjZWRBbm5vdGF0aW9uUGF0aFsxXSA9PT0gXCIvXCIpIHtcblx0XHRcdFx0cmVwbGFjZWRBbm5vdGF0aW9uUGF0aCA9IHJlcGxhY2VkQW5ub3RhdGlvblBhdGguc3Vic3RyKDEpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHNCYXNlQ29udGV4dFBhdGggKyByZXBsYWNlZEFubm90YXRpb25QYXRoO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gXCIvXCIgKyBhbm5vdGF0aW9uUGF0aDtcblx0XHR9XG5cdH07XG5cblx0Y29uc3QgZ2V0TWFuaWZlc3RXcmFwcGVyID0gZnVuY3Rpb24oKTogTWFuaWZlc3RXcmFwcGVyIHtcblx0XHRyZXR1cm4gb01hbmlmZXN0V3JhcHBlcjtcblx0fTtcblxuXHRjb25zdCBnZXRTaGVsbFNlcnZpY2VzID0gZnVuY3Rpb24oKTogSVNoZWxsU2VydmljZXNQcm94eSB7XG5cdFx0cmV0dXJuIHNoZWxsU2VydmljZXM7XG5cdH07XG5cblx0Y29uc3QgZ2V0RGlhZ25vc3RpY3MgPSBmdW5jdGlvbigpOiBJRGlhZ25vc3RpY3Mge1xuXHRcdHJldHVybiBkaWFnbm9zdGljcztcblx0fTtcblxuXHRjb25zdCBnZXRDb252ZXJ0ZXJDb250ZXh0Rm9yID0gZnVuY3Rpb24odGFyZ2V0RW50aXR5U2V0OiBFbnRpdHlTZXQpOiBDb252ZXJ0ZXJDb250ZXh0IHtcblx0XHRjb25zdCB0YXJnZXRQYXRoID0gZ2V0RGF0YU1vZGVsUGF0aEZvckVudGl0eVNldCh0YXJnZXRFbnRpdHlTZXQpO1xuXHRcdHJldHVybiBjcmVhdGVDb252ZXJ0ZXJDb250ZXh0KG9Db252ZXJ0ZWRUeXBlcywgb01hbmlmZXN0U2V0dGluZ3MsIHRlbXBsYXRlVHlwZSwgc2hlbGxTZXJ2aWNlcywgZGlhZ25vc3RpY3MsIG1lcmdlRm4sIHRhcmdldFBhdGgpO1xuXHR9O1xuXG5cdGNvbnN0IGdldEFubm90YXRpb25CeVR5cGUgPSBmdW5jdGlvbihcblx0XHR2b2NhYnVsYXJ5TmFtZToga2V5b2YgRW50aXR5VHlwZUFubm90YXRpb25zLFxuXHRcdGFubm90YXRpb25UZXJtOiBzdHJpbmcsXG5cdFx0ZW50aXR5VHlwZTogRW50aXR5VHlwZSA9IGdldEVudGl0eVR5cGUoKVxuXHQpOiBBbm5vdGF0aW9uVGVybTxhbnk+W10ge1xuXHRcdGNvbnN0IGFubm90YXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBBbm5vdGF0aW9uVGVybTxhbnk+PiA9IGVudGl0eVR5cGU/LmFubm90YXRpb25zW3ZvY2FidWxhcnlOYW1lXSB8fCB7fTtcblx0XHRsZXQgb3V0QW5ub3RhdGlvbnM6IEFubm90YXRpb25UZXJtPGFueT4gPSBbXTtcblx0XHRpZiAoYW5ub3RhdGlvbnMpIHtcblx0XHRcdG91dEFubm90YXRpb25zID0gT2JqZWN0LmtleXMoYW5ub3RhdGlvbnMpXG5cdFx0XHRcdC5maWx0ZXIoYW5ub3RhdGlvbiA9PiBhbm5vdGF0aW9uc1thbm5vdGF0aW9uXS50ZXJtID09PSBhbm5vdGF0aW9uVGVybSlcblx0XHRcdFx0LnJlZHVjZSgocHJldmlvdXNWYWx1ZTogQW5ub3RhdGlvblRlcm08YW55PltdLCBrZXk6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRcdHByZXZpb3VzVmFsdWUucHVzaChhbm5vdGF0aW9uc1trZXldKTtcblx0XHRcdFx0XHRyZXR1cm4gcHJldmlvdXNWYWx1ZTtcblx0XHRcdFx0fSwgW10pO1xuXHRcdH1cblx0XHRyZXR1cm4gb3V0QW5ub3RhdGlvbnM7XG5cdH07XG5cdFxuXHRjb25zdCBnZXRFbnRpdHlDb250YWluZXIgPSBmdW5jdGlvbigpOiBFbnRpdHlDb250YWluZXIge1xuXHRcdHJldHVybiBvQ29udmVydGVkVHlwZXMuZW50aXR5Q29udGFpbmVyO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0Z2V0QW5ub3RhdGlvbkVudGl0eVR5cGUsXG5cdFx0Z2V0TWFuaWZlc3RDb250cm9sQ29uZmlndXJhdGlvbixcblx0XHRnZXRBYnNvbHV0ZUFubm90YXRpb25QYXRoLFxuXHRcdGdldEVudGl0eVNldCxcblx0XHRnZXREYXRhTW9kZWxPYmplY3RQYXRoLFxuXHRcdGZpbmRFbnRpdHlTZXQsXG5cdFx0Z2V0RW50aXR5U2V0Rm9yRW50aXR5VHlwZSxcblx0XHRnZXRFbnRpdHlUeXBlLFxuXHRcdGdldEVudGl0eVR5cGVBbm5vdGF0aW9uLFxuXHRcdGdldFRlbXBsYXRlVHlwZSxcblx0XHRnZXRSZWxhdGl2ZUFubm90YXRpb25QYXRoLFxuXHRcdGdldEVudGl0eVNldEJhc2VkQW5ub3RhdGlvblBhdGgsXG5cdFx0Z2V0TWFuaWZlc3RXcmFwcGVyLFxuXHRcdGdldFNoZWxsU2VydmljZXMsXG5cdFx0Z2V0RGlhZ25vc3RpY3MsXG5cdFx0Z2V0Q29udmVydGVyQ29udGV4dEZvcixcblx0XHRnZXRFbnRpdHlQcm9wZXJ0eUZyb21GdWxseVF1YWxpZmllZE5hbWUsXG5cdFx0Z2V0QW5ub3RhdGlvbkJ5VHlwZSxcblx0XHRnZXRFbnRpdHlDb250YWluZXJcblx0fTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgdGhlIGNvbnZlcnRlciBjb250ZXh0IG5lY2Vzc2FyeSBmb3IgYSBtYWNybyBiYXNlZCBvbiBhIG1ldGFtb2RlbCBjb250ZXh0LlxuICogQHBhcmFtIHNFbnRpdHlTZXROYW1lXG4gKiBAcGFyYW0gb01ldGFNb2RlbENvbnRleHRcbiAqIEBwYXJhbSB0ZW1wbGF0ZVR5cGVcbiAqIEBwYXJhbSBzaGVsbFNlcnZpY2VzXG4gKiBAcGFyYW0gZGlhZ25vc3RpY3NcbiAqIEBwYXJhbSBtZXJnZUZuXG4gKiBAcGFyYW0gdGFyZ2V0RGF0YU1vZGVsUGF0aFxuICogQHBhcmFtIG1hbmlmZXN0U2V0dGluZ3NcbiAqIEByZXR1cm5zIHtDb252ZXJ0ZXJDb250ZXh0fSB0aGUgY3VycmVudCBjb252ZXJ0ZXIgY29udGV4dFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29udmVydGVyQ29udGV4dEZvck1hY3JvKFxuXHRzRW50aXR5U2V0TmFtZTogc3RyaW5nLFxuXHRvTWV0YU1vZGVsQ29udGV4dDogQ29udGV4dCB8IE9EYXRhTWV0YU1vZGVsLFxuXHR0ZW1wbGF0ZVR5cGU6IFRlbXBsYXRlVHlwZSxcblx0c2hlbGxTZXJ2aWNlczogSVNoZWxsU2VydmljZXNQcm94eSxcblx0ZGlhZ25vc3RpY3M6IElEaWFnbm9zdGljcyxcblx0bWVyZ2VGbjogRnVuY3Rpb24sXG5cdHRhcmdldERhdGFNb2RlbFBhdGg6IERhdGFNb2RlbE9iamVjdFBhdGggfCB1bmRlZmluZWQsXG5cdG1hbmlmZXN0U2V0dGluZ3M6IEJhc2VNYW5pZmVzdFNldHRpbmdzID0ge30gYXMgQmFzZU1hbmlmZXN0U2V0dGluZ3Ncbik6IENvbnZlcnRlckNvbnRleHQge1xuXHRjb25zdCBvTWV0YU1vZGVsOiBPRGF0YU1ldGFNb2RlbCA9IG9NZXRhTW9kZWxDb250ZXh0LmlzQShcInNhcC51aS5tb2RlbC5vZGF0YS52NC5PRGF0YU1ldGFNb2RlbFwiKVxuXHRcdD8gKG9NZXRhTW9kZWxDb250ZXh0IGFzIE9EYXRhTWV0YU1vZGVsKVxuXHRcdDogKCgob01ldGFNb2RlbENvbnRleHQgYXMgQ29udGV4dCkuZ2V0TW9kZWwoKSBhcyB1bmtub3duKSBhcyBPRGF0YU1ldGFNb2RlbCk7XG5cdGNvbnN0IG9Db252ZXJ0ZXJPdXRwdXQgPSBjb252ZXJ0VHlwZXMob01ldGFNb2RlbCk7XG5cdGNvbnN0IHRhcmdldEVudGl0eVNldCA9IG9Db252ZXJ0ZXJPdXRwdXQuZW50aXR5U2V0cy5maW5kKGVudGl0eVNldCA9PiBlbnRpdHlTZXQubmFtZSA9PT0gc0VudGl0eVNldE5hbWUpIGFzIEVudGl0eVNldDtcblx0aWYgKCF0YXJnZXREYXRhTW9kZWxQYXRoKSB7XG5cdFx0dGFyZ2V0RGF0YU1vZGVsUGF0aCA9IHtcblx0XHRcdHN0YXJ0aW5nRW50aXR5U2V0OiB0YXJnZXRFbnRpdHlTZXQsXG5cdFx0XHRuYXZpZ2F0aW9uUHJvcGVydGllczogW10sXG5cdFx0XHR0YXJnZXRFbnRpdHlTZXQ6IHRhcmdldEVudGl0eVNldCxcblx0XHRcdHRhcmdldEVudGl0eVR5cGU6IHRhcmdldEVudGl0eVNldC5lbnRpdHlUeXBlLFxuXHRcdFx0dGFyZ2V0T2JqZWN0OiB0YXJnZXRFbnRpdHlTZXRcblx0XHR9O1xuXHR9XG5cdHJldHVybiBjcmVhdGVDb252ZXJ0ZXJDb250ZXh0KFxuXHRcdG9Db252ZXJ0ZXJPdXRwdXQsXG5cdFx0bWFuaWZlc3RTZXR0aW5ncyxcblx0XHR0ZW1wbGF0ZVR5cGUsXG5cdFx0c2hlbGxTZXJ2aWNlcyxcblx0XHRkaWFnbm9zdGljcyxcblx0XHRtZXJnZUZuLFxuXHRcdHRhcmdldERhdGFNb2RlbFBhdGhcblx0KTtcbn1cbiJdfQ==