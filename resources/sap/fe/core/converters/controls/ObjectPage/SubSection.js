sap.ui.define(["../../ManifestSettings","../../helpers/ID","../Common/Form","../Common/DataVisualization","../../helpers/ConfigurableObject","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingExpression","sap/fe/core/converters/helpers/IssueManager"],function(M,I,F,D,C,A,K,B,a){"use strict";var _={};var b=a.IssueCategory;var c=a.IssueSeverity;var d=a.IssueType;var r=B.ref;var e=B.not;var f=B.fn;var g=B.equal;var h=B.compileBinding;var j=B.bindingExpression;var k=B.annotationExpression;var l=K.KeyHelper;var m=A.getSemanticObjectMapping;var p=A.ButtonType;var q=A.isActionNavigable;var s=A.getEnabledBinding;var t=A.getActionsFromManifest;var P=C.Placement;var u=C.insertCustomElements;var v=D.getDataVisualizationConfiguration;var w=F.isReferenceFacet;var x=F.createFormDefinition;var S=I.SubSectionID;var y=I.FormID;var z=I.CustomSubSectionID;var E=M.ActionType;function G(n,i){return L(n)||J(n,i)||U(n,i)||H();}function H(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function J(n,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(n)))return;var o=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=n[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){o.push(_s.value);if(i&&o.length===i)break;}}catch(m1){_d=true;_e=m1;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return o;}function L(i){if(Array.isArray(i))return i;}function N(o,i){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var m1=Object.getOwnPropertySymbols(o);if(i)m1=m1.filter(function(n1){return Object.getOwnPropertyDescriptor(o,n1).enumerable;});n.push.apply(n,m1);}return n;}function O(n){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};if(i%2){N(Object(o),true).forEach(function(m1){Q(n,m1,o[m1]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(n,Object.getOwnPropertyDescriptors(o));}else{N(Object(o)).forEach(function(m1){Object.defineProperty(n,m1,Object.getOwnPropertyDescriptor(o,m1));});}}return n;}function Q(o,i,n){if(i in o){Object.defineProperty(o,i,{value:n,enumerable:true,configurable:true,writable:true});}else{o[i]=n;}return o;}function R(i){return W(i)||V(i)||U(i)||T();}function T(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function U(o,i){if(!o)return;if(typeof o==="string")return X(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(o,i);}function V(i){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(i))return Array.from(i);}function W(i){if(Array.isArray(i))return X(i);}function X(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,m1=new Array(o);i<o;i++){m1[i]=n[i];}return m1;}var Y;(function(Y){Y["Unknown"]="Unknown";Y["Form"]="Form";Y["DataVisualization"]="DataVisualization";Y["XMLFragment"]="XMLFragment";Y["Placeholder"]="Placeholder";Y["Mixed"]="Mixed";})(Y||(Y={}));_.SubSectionType=Y;var Z=["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.PresentationVariant","com.sap.vocabularies.UI.v1.SelectionPresentationVariant"];var $=function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return i.some(function(n){var o,m1;return Z.indexOf(n===null||n===void 0?void 0:(o=n.Target)===null||o===void 0?void 0:(m1=o.$target)===null||m1===void 0?void 0:m1.term)>-1;});};function a1(i,n){var o=i.reduce(function(o,m1){switch(m1.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":o.push(m1);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":if(m1.Facets.find(function(n1){return n1.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet";})){o.splice.apply(o,[o.length,0].concat(R(m1.Facets)));}else{o.push(m1);}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":break;}return o;},[]);return o.map(function(m1){var n1,o1;return e1(m1,o,n,0,!((n1=m1)===null||n1===void 0?void 0:(o1=n1.Facets)===null||o1===void 0?void 0:o1.length));});}_.createSubSections=a1;var b1=function(i,n){var o,m1;return((o=i.ID)===null||o===void 0?void 0:o.toString())||((m1=i.Label)===null||m1===void 0?void 0:m1.toString())||n;};function c1(i,n){var o=new Array();switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":o=i.Facets.filter(function(i){return w(i);}).reduce(function(o,i){return g1(o,i,n);},[]);break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":o=g1([],i,n);break;}return o;}function d1(i){var n=i===null||i===void 0?void 0:i.path;if(n){return"{= "+"!${"+n+"} ? '"+p.Transparent+"' : ${"+n+"}"+"}";}else if(i){return p.Ghost;}return p.Transparent;}function e1(n,o,m1,n1,o1){var p1,q1,r1,s1,t1;var u1=S({Facet:n});var v1={id:u1,key:b1(n,u1),title:h(k(n.Label)),type:Y.Unknown,annotationPath:m1.getEntitySetBasedAnnotationPath(n.fullyQualifiedName),visible:h(e(g(k((p1=n.annotations)===null||p1===void 0?void 0:(q1=p1.UI)===null||q1===void 0?void 0:q1.Hidden),true))),level:n1};var w1=[];var x1=[];var y1=[];var z1="";n1++;switch(n.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":var A1=n.Facets;if($(A1)){for(var i=0;i<A1.length;i++){var B1,C1;if(Z.indexOf((B1=A1[i].Target)===null||B1===void 0?void 0:(C1=B1.$target)===null||C1===void 0?void 0:C1.term)>-1){x1.push(e1(A1[i],[],m1,n1,A1.length===1));y1.push(i);}}for(var _i=y1.length-1;_i>=0;_i--){A1.splice(y1[_i],1);}if(A1.length){n.Facets=A1;w1.push(e1(n,[],m1,n1,o1));}w1=w1.concat(x1);var E1=O({},v1,{type:Y.Mixed,level:n1,content:w1});return E1;}else{var F1=O({},v1,{type:Y.Form,formDefinition:x(n,m1),level:n1,actions:c1(n,m1)});return F1;}case"com.sap.vocabularies.UI.v1.ReferenceFacet":if(!n.Target.$target){z1="Unable to find annotationPath ".concat(n.Target.value);}else{switch(n.Target.$target.term){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.PresentationVariant":case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":var G1=v(n.Target.value,k1(n,o,m1),m1);var H1=(r1=G1.visualizations[0])===null||r1===void 0?void 0:(s1=r1.annotation)===null||s1===void 0?void 0:s1.title;H1?H1:H1=(t1=G1.visualizations[0])===null||t1===void 0?void 0:t1.title;var I1=O({},v1,{type:Y.DataVisualization,level:n1,presentation:G1,showTitle:f1(o1,v1.title,H1)});return I1;case"com.sap.vocabularies.UI.v1.FieldGroup":case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.DataPoint":case"com.sap.vocabularies.UI.v1.StatusInfo":case"com.sap.vocabularies.Communication.v1.Contact":var J1=O({},v1,{type:Y.Form,level:n1,formDefinition:x(n,m1),actions:c1(n,m1)});return J1;default:z1="For ".concat(n.Target.$target.term," Fragment");break;}}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":z1="For Reference URL Facet";break;default:break;}var K1=O({},v1,{text:z1});return K1;}_.createSubSection=e1;function f1(i,n,o){if(i&&o===n){return false;}return true;}function g1(i,n,o){var m1=n.Target.$target;var n1=n.Target.value;var o1={};var p1=[];var q1=n1.split("@"),r1=G(q1,1),s1=r1[0];if(s1.length>0){if(s1.lastIndexOf("/")===s1.length-1){s1=s1.substr(0,s1.length-1);}}else{s1=undefined;}if(m1){switch(m1.term){case"com.sap.vocabularies.UI.v1.FieldGroup":p1=m1.Data;o1=t(o.getManifestControlConfiguration(m1).actions,o);break;case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.StatusInfo":if(m1.qualifier){p1=m1;}break;}}return p1.reduce(function(i,t1){var u1,v1,w1,x1,y1;var z1=t1===null||t1===void 0?void 0:(u1=t1.annotations)===null||u1===void 0?void 0:u1.UI;switch(t1.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":if(t1.RequiresContext===true){o.getDiagnostics().addIssue(b.Annotation,c.Low,d.MALFORMED_DATAFIELD_FOR_IBN.REQUIRESCONTEXT);}if(t1.Inline===true){o.getDiagnostics().addIssue(b.Annotation,c.Low,d.MALFORMED_DATAFIELD_FOR_IBN.INLINE);}var A1={};if(t1.Mapping){A1.semanticObjectMapping=m(t1.Mapping);}i.push({type:E.DataFieldForIntentBasedNavigation,id:y({Facet:n},t1),key:l.generateKeyFromDataField(t1),text:t1.Label,annotationPath:"",visible:h(e(g(k((v1=t1.annotations)===null||v1===void 0?void 0:(w1=v1.UI)===null||w1===void 0?void 0:w1.Hidden),true))),buttonType:d1(z1===null||z1===void 0?void 0:z1.Emphasized),press:h(f("._intentBasedNavigation.navigate",[k(t1.SemanticObject),k(t1.Action),A1])),customData:h({semanticObject:k(t1.SemanticObject),action:k(t1.Action)})});break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":var B1=o.getManifestControlConfiguration(m1).actions;var C1=l.generateKeyFromDataField(t1);i.push({type:E.DataFieldForAction,id:y({Facet:n},t1),key:C1,text:t1.Label,annotationPath:"",enabled:s(t1.ActionTarget),binding:s1?"{ 'path' : '"+s1+"'}":undefined,visible:h(e(g(k((x1=t1.annotations)===null||x1===void 0?void 0:(y1=x1.UI)===null||y1===void 0?void 0:y1.Hidden),true))),requiresDialog:h1(t1.ActionTarget),buttonType:d1(z1===null||z1===void 0?void 0:z1.Emphasized),press:h(f("invokeAction",[t1.Action,{contexts:f("getBindingContext",[],j("","$source")),invocationGrouping:t1.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated",label:k(t1.Label),model:f("getModel",[],j("/","$source")),isNavigable:q(B1&&B1[C1])}],r(".editFlow")))});break;}i=u(i,o1);return i;},i);}function h1(i){if(i){var n,o;var m1=(n=i.annotations)===null||n===void 0?void 0:(o=n.Common)===null||o===void 0?void 0:o.IsActionCritical;if(i.parameters.length>1||m1){return"Dialog";}else{return"None";}}else{return"None";}}_.isDialog=h1;function i1(i,n){var o={};Object.keys(i).forEach(function(m1){return o[m1]=j1(i[m1],m1,n);});return o;}_.createCustomSubSections=i1;function j1(i,n,o){var m1=i.position;if(!m1){m1={placement:P.After};}var n1={type:Y.Unknown,id:i.id||z(n),actions:t(i.actions,o),key:n,title:i.title,level:1,position:m1,visible:i.visible};if(i.template||i.name){n1.type=Y.XMLFragment;n1.template=i.template||i.name||"";}else{n1.type=Y.Placeholder;}return n1;}_.createCustomSubSection=j1;function k1(i,n,o){var m1=o.getManifestWrapper();if(m1.useIconTabBar()){return l1(i,n);}else{var n1,o1,p1,q1,r1,s1;var t1=o.getEntityType();if(((n1=t1.annotations)===null||n1===void 0?void 0:(o1=n1.UI)===null||o1===void 0?void 0:(p1=o1.Facets)===null||p1===void 0?void 0:p1.length)&&((q1=t1.annotations)===null||q1===void 0?void 0:(r1=q1.UI)===null||r1===void 0?void 0:(s1=r1.Facets)===null||s1===void 0?void 0:s1.length)>1){return l1(i,n);}else{return true;}}}function l1(i,n){return n.every(function(o){if(o!==i){if(o.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"){var m1,n1,o1,p1,q1;var r1=o;if(((m1=r1.Target)===null||m1===void 0?void 0:(n1=m1.$target)===null||n1===void 0?void 0:n1.term)==="com.sap.vocabularies.UI.v1.LineItem"||((o1=r1.Target)===null||o1===void 0?void 0:(p1=o1.$target)===null||p1===void 0?void 0:p1.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((q1=r1.Target.$target)===null||q1===void 0?void 0:q1.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var s1,t1,u1,v1;return((s1=r1.annotations)===null||s1===void 0?void 0:(t1=s1.UI)===null||t1===void 0?void 0:t1.Hidden)!==undefined?(u1=r1.annotations)===null||u1===void 0?void 0:(v1=u1.UI)===null||v1===void 0?void 0:v1.Hidden:false;}return true;}else{var w1=o;return w1.Facets.every(function(x1){var y1,z1,A1,B1,C1,D1;var E1=x1;if(((y1=E1.Target)===null||y1===void 0?void 0:(z1=y1.$target)===null||z1===void 0?void 0:z1.term)==="com.sap.vocabularies.UI.v1.LineItem"||((A1=E1.Target)===null||A1===void 0?void 0:(B1=A1.$target)===null||B1===void 0?void 0:B1.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((C1=E1.Target)===null||C1===void 0?void 0:(D1=C1.$target)===null||D1===void 0?void 0:D1.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var F1,G1,H1,I1;return((F1=E1.annotations)===null||F1===void 0?void 0:(G1=F1.UI)===null||G1===void 0?void 0:G1.Hidden)!==undefined?(H1=E1.annotations)===null||H1===void 0?void 0:(I1=H1.UI)===null||I1===void 0?void 0:I1.Hidden:false;}return true;});}}return true;});}return _;},false);
