sap.ui.define(["./BaseAPI","sap/fe/test/Utils","sap/ui/test/OpaBuilder","sap/ui/test/actions/Action","sap/fe/test/builder/FEBuilder","sap/fe/test/builder/MdcFilterBarBuilder","sap/fe/test/builder/MdcFilterFieldBuilder","sap/fe/macros/filter/DraftEditState"],function(B,U,O,A,F,a,b,E){"use strict";var c=function(f,v){if(!U.isOfType(f,a)){throw new Error("oFilterBarBuilder parameter must be a FilterBarBuilder instance");}return B.call(this,f,v);};c.prototype=Object.create(B.prototype);c.prototype.constructor=c;c.EditState={All:E.ALL.id,Unchanged:E.UNCHANGED.id,OwnDraft:E.OWN_DRAFT.id,Locked:E.LOCKED.id,UnsavedChanges:E.UNSAVED_CHANGES.id};c.prototype.createFilterFieldBuilder=function(f){var o=this.getBuilder(),v;if(U.isOfType(f,String)){v=O.Matchers.properties({label:f});}else{v=F.Matchers.id(RegExp(U.formatMessage("::FilterField::{0}$",f.property.replace(/\/|\*\//g,"::"))));}o.hasField(v,true);return b.create(this.getOpaInstance()).options(o.build());};c.prototype.iOpenFilterAdaptation=function(){var f=this.getBuilder();return this.prepareResult(f.doOpenSettings().success(F.create(this.getOpaInstance()).hasType("sap.m.Panel").isDialogElement().doConditional(function(p){return!p.getExpanded();},O.Actions.press("expandButton"))).description(U.formatMessage("Opening the filter bar adaptation dialog for '{0}'",this.getIdentifier())).execute());};c.prototype.iConfirmFilterAdaptation=function(){return this.prepareResult(a.createAdaptationDialogBuilder(this.getOpaInstance()).doPressFooterButton(O.Matchers.resourceBundle("text","sap.ui.mdc","p13nDialog.OK")).description(U.formatMessage("Closing the filter bar adaptation dialog for '{0}'",this.getIdentifier())).execute());};c.prototype.filterFieldAdaptation=function(f,s,v,d){var e=U.parseArguments([[String,Object],Object,[Function,Array,A],String],arguments),o=F.create(this.getOpaInstance()),p,g=F.create(this.getOpaInstance()).hasType("sap.m.CustomListItem").isDialogElement(),h=a.createAdaptationDialogBuilder(this.getOpaInstance());f=e[0];if(U.isOfType(f,String)){g.has(O.Matchers.bindingProperties(B.MDC_P13N_MODEL,{label:f}));}else{g.has(O.Matchers.bindingProperties(B.MDC_P13N_MODEL,{name:f.property}));}s=e[1];var C=s&&s.visible===false;if(!C&&!U.isOfType(s,[null,undefined])){g.has(O.Matchers.bindingProperties(B.MDC_P13N_MODEL,s));}v=e[2];if(!U.isOfType(v,[null,undefined])){h.do(v);}d=e[3];return this.prepareResult(o.success(function(){p=F.controlsExist(h);if(!p){this.iOpenFilterAdaptation();}if(!p){h.success(this.iConfirmFilterAdaptation.bind(this));}return h.has(O.Matchers.children(g)).has(function(i){if(C){return i.length===0;}return F.Matchers.atIndex(0)(i);}).description(d).execute();}.bind(this)).execute());};return c;});
