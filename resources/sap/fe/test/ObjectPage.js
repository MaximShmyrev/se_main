sap.ui.define(["sap/base/util/merge","./TemplatePage","sap/ui/test/OpaBuilder","sap/ui/test/Opa5","sap/fe/test/Utils","sap/fe/test/builder/FEBuilder","sap/fe/test/builder/MacroFieldBuilder","sap/fe/test/builder/OverflowToolbarBuilder","sap/fe/test/api/FooterActionsOP","sap/fe/test/api/FooterAssertionsOP","sap/fe/test/api/HeaderActions","sap/fe/test/api/HeaderAssertions","sap/fe/test/api/FormActions","sap/fe/test/api/FormAssertions","sap/fe/core/helpers/StableIdHelper"],function(m,T,O,a,U,F,b,c,d,e,H,f,g,h,S){"use strict";function i(N){return"fe::table::"+N.split("/").join("::")+"::LineItem";}function j(N,P){return i(N)+"::TableValueHelp::"+P.split("/").join("::");}function k(E){return"fe::Chart::"+E+"::Chart";}function _(s,r,t,u,v){var I="fe::";if(typeof t==="string"){I+="FormContainer";I+="::"+S.prepareId(t);if(v){I+="::FieldValueHelp";I+="::"+s;}else{I+="::FormElement";I+="::DataField";I+="::"+s;I+="::Field";}}else if(typeof u==="string"){I+="HeaderFacet";I+="::Form";I+="::"+S.prepareId(u);I+="::DataField";I+="::"+s;I+="::Field";}I=S.prepareId(I);return I;}function l(r){return _(r.field,"",r.facet,r.headerFacet,true);}function n(r,s){return _(r.field,s||"",r.facet,r.headerFacet,false);}function o(v,r){return c.create(v).hasId(r.id);}function p(v,r){return F.create(v).hasId(r.id);}function q(v,r){var s=F.create(v);if(U.isOfType(r,String)){s.hasType("sap.uxap.ObjectPageSubSection");s.hasProperties({title:r});}else if(r.fieldGroupId){if(r.fullSubSectionId){s.hasId(r.fieldGroupId).has(O.Matchers.ancestor(r.fullSubSectionId,false));}else{s.hasId(r.fieldGroupId);}}else{s.hasId(r.id);}return s;}return function(P){var A=P.appId,C=P.componentId,V=A+"::"+C,r=V+"--fe::ObjectPage",s="fe::HeaderFacet",t="fe::ObjectPage-OPHeaderContent",u="fe::FooterBar",v="fe::FacetSubSection",w="fe::Form",x="fe::FormContainer",y="fe::HeaderFacet::FormContainer",B=V+"--fe::Breadcrumbs",z="fe::ObjectPage-anchBar",D="fe::Paginator",E={DISPLAY:"Display",EDITABLE:"Editable"},R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core"),G=Array.prototype.slice.call(arguments,1);return T.apply(T,[V,{actions:{onTable:function(I){if(!U.isOfType(I,String)){I={id:i(I.property)};}return this._onTable(I);},onChart:function(I){var J;if(I){J=!U.isOfType(I,String)?k(I.property):I;}return this._onChart({id:J});},onFooter:function(){return new d(o(this,{id:u}),{id:u});},onHeader:function(){return new H(p(this,{id:r}),{id:r,headerId:s,headerContentId:t,viewId:V,paginatorId:D,breadCrumbId:B});},onForm:function(I){if(!U.isOfType(I,String)){if(I.section){I.id=v+"::"+I.section;I.fullSubSectionId=V+"--"+I.id;}if(I.fieldGroup){if(I.isHeaderFacet){I.fieldGroupId=y+"::"+I.fieldGroup;}else{I.fieldGroupId=x+"::"+I.fieldGroup;}}}return new g(q(this,I),I);},iClickQuickViewMoreLinksButton:function(){return O.create(this).hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.POPOVER_DEFINE_LINKS")).doPress().description("Pressing 'More Links' button").execute();},iClickLinkWithText:function(I){return O.create(this).hasType("sap.m.Link").hasProperties({text:I}).doPress().description("Navigating via link '"+I+"'").execute();},iEnableLink:function(I){return O.create(this).hasType("sap.m.ColumnListItem").hasAggregationProperties("cells",{text:I}).isDialogElement().doPress("selectMulti").description("The CheckBox for link "+I+" is selected").execute();},iOpenVHDialog:function(I){var J=n(I)+"-edit-inner-vhi";return O.create(this).hasId(J).doPress().description("Opening value help for '"+I.field+"'").execute();},iPressKeyboardShortcutOnSection:function(I,J){return this._iPressKeyboardShortcut(undefined,I,J,"sap.uxap.ObjectPageSection");},iSelectFromVHDTable:function(I){return O.create(this).hasType("sap.m.ColumnListItem").hasAggregationProperties("cells",{value:I}).checkNumberOfMatches(1).isDialogElement().doPress().description("Selecting row from dialog with value '"+I+"'").execute();},iConfirmTableVHD:function(I,J){var K=j(I,J);var L=O.create(this).hasId(K+"-ok").doPress().description("Confirming value help selection for '"+J+"'").execute();return L;},iConfirmFacetVHD:function(I){var J=l(I)+"-ok";return O.create(this).hasId(J).doPress().description("Confirming value help selection for '"+I.field+"'").execute();},iCancelDialog:function(){return this.iConfirmDialogWithButtonText(R.getText("C_COMMON_OBJECT_PAGE_CANCEL"));},iOpenSectionWithTitle:function(N){return O.create(this).hasId(z).has(O.Matchers.children(F.Matchers.states({controlType:"sap.m.Button",text:N}))).doPress().description("Selecting section "+N).execute();},iClickCreateButton:function(){return O.create(this).isDialogElement().hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.fe.core","C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE")).doPress().description("Pressing Create button on sticky creation dialog.").execute();},iOpenVHDInCreateDialog:function(I){return O.create(this).isDialogElement().hasId(I+"-inner-vhi").doPress().description("Opening value help for '"+I+"' from within the create dialog").execute();},iConfirmVHDInCreateDialog:function(I){return O.create(this).isDialogElement().hasId(I+"::VH-ok").doPress().description("Comfirmed VHD opened from create dialog").execute();},iEnterValueForFieldInCreateDialog:function(I,J){return O.create(this).isDialogElement().hasId(I).doEnterText(J).description("Entering Text in the field '"+I+"'in the create dialog with value '"+J+"'").execute();},iClickOnMessageButton:function(){return O.create(this).hasType("sap.fe.templates.controls.messages.MessageButton").doPress().description("Clicked on Message Button").execute();},iClickOnMessage:function(M){return O.create(this).hasType("sap.m.MessageListItem").hasProperties({title:M.MessageText,groupAnnouncement:M.GroupLabel}).isDialogElement(true).description("MessageItem with correct text and group label").doOnChildren(O.create(this).hasType("sap.m.Link").hasProperties({text:M.MessageText}).doPress().description("Click on the message")).execute();}},assertions:{onTable:function(I){if(!U.isOfType(I,String)){I={id:i(I.property)};}return this._onTable(I);},onChart:function(I){var J;if(I){J=!U.isOfType(I,String)?k(I.property):I;}return this._onChart({id:J});},onFooter:function(){return new e(o(this,{id:u}),{id:u});},onHeader:function(){return new f(p(this,{id:r}),{id:r,headerId:s,headerContentId:t,viewId:V,paginatorId:D,breadCrumbId:B});},onForm:function(I){if(!U.isOfType(I,String)){if(I.section){I.id=v+"::"+I.section;I.fullSubSectionId=V+"--"+I.id;}if(I.fieldGroup){I.fieldGroupId=x+"::"+I.fieldGroup;}}return new h(q(this,I),I);},iSeeLinkWithText:function(I){return O.create(this).hasType("sap.m.Link").hasProperties({text:I}).description("Seeing link with text '"+I+"'").execute();},iSeeTextWithText:function(I){return O.create(this).hasType("sap.m.Text").hasProperties({text:I}).description("Seeing Text with text '"+I+"'").execute();},iSeeTitleWithText:function(I){return O.create(this).hasType("sap.m.Title").hasProperties({text:I}).description("Seeing Title with text '"+I+"'").execute();},iSeeContactDetailsPopover:function(I){return(O.create(this).hasType("sap.ui.mdc.link.Panel").description("Contact card with title '"+I+"' is present").execute());},iSeeQuickViewPopover:function(){return O.create(this).hasType("sap.ui.mdc.link.Panel").description("Seeing Quick View Details in ObjectPage").execute();},iSeeQuickViewMoreLinksButton:function(){return O.create(this).isDialogElement(true).hasType("sap.m.Button").has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.POPOVER_DEFINE_LINKS")).description("The 'More Links' button found").execute();},iSeeObjectPageInDisplayMode:function(){return this._iSeeObjectPageInMode(E.DISPLAY);},iSeeObjectPageInEditMode:function(){return this._iSeeObjectPageInMode(E.EDITABLE);},_iSeeObjectPageInMode:function(M){return O.create(this).hasId(V).viewId(null).has(function(I){return I.getModel("ui").getProperty("/editMode")===M;}).description("Object Page is in mode '"+M+"'").execute();},iSeeSectionWithTitle:function(I){return O.create(this).hasType("sap.uxap.ObjectPageSection").hasProperties({title:I}).description("Seeing section with title '"+I+"'").execute();},iSeeSubSectionWithTitle:function(I){return O.create(this).hasType("sap.uxap.ObjectPageSubSection").hasProperties({title:I}).description("Seeing sub-section with title '"+I+"'").execute();},iSeeSectionButtonWithTitle:function(I,J){return F.create(this).hasId(z).has(O.Matchers.children(F.Matchers.states(m({},{controlType:"sap.m.Button",text:I},J)))).description(U.formatMessage("Seeing section button with title '{0}' and state='{1}'",I,J)).execute();},iSeeFlpLink:function(I){return O.create(this).hasType("sap.ui.mdc.link.PanelListItem").isDialogElement(true).hasProperties({text:I}).description("FLP link with text '"+I+"' is present").execute();},iSeeSelectLinksDialog:function(){return O.create(this).hasType("sap.m.Title").isDialogElement(true).has(O.Matchers.resourceBundle("text","sap.ui.mdc","info.SELECTION_DIALOG_ALIGNEDTITLE")).description("Seeing dialog open").execute();},iDoNotSeeFlpLink:function(I){return O.create(this).hasType("sap.m.Link").isDialogElement(true).check(function(J){var K=J.some(function(L){return L.getText()===I;});return K===false;},true).description("FLP link with text '"+I+"' is not found").execute();},iSeeTitleLink:function(I,J){return O.create(this).hasType("sap.m.Link").isDialogElement(true).hasProperties({text:I,href:J}).description("QuickView Title link with text '"+I+"' is found").execute();},iSeeVHD:function(I){var J=l(I)+"-dialog";return O.create(this).hasId(J).description("Seeing value help dialog for field '"+I.field+"'").execute();},iSeeVHDTable:function(I){var J=l(I)+"::Table";return O.create(this).hasId(J).hasAggregation("items").description("Seeing filled value help dialog for field '"+I.field+"'").execute();},iSeeVHDFilterBar:function(I){var J=l(I)+"::FilterBar";return O.create(this).hasId(J).description("Seeing value help filterbar for field '"+I.field+"'").execute();},iSeeCreateConfirmation:function(){return this._iSeeTheMessageToast(R.getText("C_TRANSACTION_HELPER_OBJECT_CREATED"));},iSeeSaveConfirmation:function(){return this._iSeeTheMessageToast(R.getText("C_TRANSACTION_HELPER_OBJECT_SAVED"));},iSeeDeleteConfirmation:function(){return this._iSeeTheMessageToast(R.getText("C_TRANSACTION_HELPER_OBJECT_PAGE_DELETE_TOAST_SINGULAR"));},iSeeConfirmMessageBoxWithTitle:function(I){return O.create(this).hasType("sap.m.Dialog").isDialogElement(true).hasProperties({title:I}).description("Seeing Message dialog open").execute();},iSeeMoreFormContent:function(I){return O.create(this).hasId(w+"::"+I+"::MoreContent").description("Seeing More Form Content in "+I).execute();},iDoNotSeeMoreFormContent:function(I){return O.create(this).hasType("sap.ui.layout.form.Form").check(function(J){var K=J.some(function(L){return L.getId().includes(I+"::MoreContent");});return K===false;}).description("Not Seeing More Form Content in "+I).execute();},iSeeControlVMTableTitle:function(I,N){return O.create(this).hasType("sap.m.Title").hasId(i(N)+"::VM-text").hasProperties({text:I}).description("Seeing variant title '"+I+"'").execute();},iCheckCreateDialog:function(){return O.create(this).isDialogElement().hasType("sap.m.Dialog").has(O.Matchers.resourceBundle("title","sap.fe.core","C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE")).description("Creation dialog is opened").execute();},iCheckValueOfFieldInCreateDialog:function(I,J,K,L){return b.create(this).isDialogElement().hasId(I).hasValue(J,K).hasProperties({required:!!L}).description(U.formatMessage("Seeing field '{0}' with value '{1}'",I,[].concat(J,K||[]))).execute();},iSeeCreateButton:function(I){I=I!==false;return F.create(this).hasType("sap.m.Button").hasProperties({text:"Create"}).isDialogElement(true).mustBeEnabled(I).checkNumberOfMatches(1).description("Create button is visible").execute();},iSeeMessageView:function(){return O.create(this).hasType("sap.m.MessageView").isDialogElement(true).description("MessageView is visible").execute();},iCheckMessageItemsOrder:function(I){return O.create(this).hasType("sap.m.MessageView").check(function(M){var J=M[0].getItems();return(J[0].getGroupName()===I[0].GroupLabel&&J[1].getGroupName()===I[1].GroupLabel&&J[0].getTitle()===I[0].MessageText&&J[1].getTitle()===I[1].MessageText);},true).isDialogElement(true).description("MessageItems are correctly ordered").execute();},iClickBackOnMessageView:function(){return O.create(this).hasType("sap.m.MessageView").isDialogElement(true).doOnChildren(O.create(this).hasType("sap.m.Button").hasProperties({icon:"sap-icon://nav-back"}).doPress().description("Click on the message view back")).execute();},iSeeMessageItem:function(M){return O.create(this).hasType("sap.m.MessageListItem").hasProperties({title:M.MessageText,groupAnnouncement:M.GroupLabel}).isDialogElement(true).description("MessageItem with correct text and group label").execute();}}}].concat(G));};});
