// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/Avatar","sap/m/library","sap/ushell/library","sap/ui/core/CustomData","sap/ui/core/IconPool","sap/ui/Device","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/footerbar/EndUserFeedback","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/ui/shell/ShellNavigationMenu","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(A,m,u,C,I,D,a,E,r,b,c,d,S,e,f){"use strict";var g=u.AppTitleState;var F=S.prototype.FloatingNumberType;var h=m.AvatarSize;var i=[];var j=[];function k(z,H,B){i.push(o(z));i.push(p(H));i.push(t(H,B));i.push(q(B));if(a.last("/core/shell/model/enableNotifications")){i.push(s(B));}if(z.moveAppFinderActionToShellHeader&&a.last("/core/catalog/enabled")){i.push(v(z,H));}if(z.moveUserSettingsActionToShellHeader){i.push(n(H));}if(z.moveContactSupportActionToShellHeader){i.push(w());}if(z.moveGiveFeedbackActionToShellHeader){i.push(x());}if(a.last("/core/productSwitch/enabled")){i.push(y());}j.push(E.once("CoreResourcesComplementLoaded").do(function(){_(z,B,H);}));}function l(){i.forEach(function(z){var B=sap.ui.getCore().byId(z);if(B){if(B.destroyContent){B.destroyContent();}B.destroy();}});j.forEach(function(z){z.off();});i=[];j=[];}function _(z,B,G){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile"],function(H,N){var M="shellNavigationMenu";var J=function(P,Q){var T=Q.getProperty("icon")||"sap-icon://circle-task-2",U=Q.getProperty("title"),V=Q.getProperty("subtitle"),W=Q.getProperty("intent");var X=(new H({type:"Active",title:U,description:V,icon:T,wrapping:true,customData:[new C({key:"intent",value:W})],press:[G.handleNavigationMenuItemPress,G]})).addStyleClass("sapUshellNavigationMenuListItems");return X;};var R=function(P,Q){var T=Q.getProperty("icon"),U=Q.getProperty("title"),V=Q.getProperty("subtitle"),W=Q.getProperty("intent");return new N({title:U,subtitle:V,icon:T,intent:W,press:function(){var X=this.getIntent();if(X&&X[0]==="#"){G.navigateFromShellApplicationNavigationMenu(X);}}});};var K=new e(M,{title:"{/application/title}",icon:"{/application/icon}",showTitle:"{/application/showNavMenuTitle}",showRelatedApps:z.appState!=="lean",items:{path:"/application/hierarchy",factory:J.bind(this)},miniTiles:{path:"/application/relatedApps",factory:R.bind(this)},visible:{path:"/ShellAppTitleState",formatter:function(P){return P===g.ShellNavMenu;}}});var L=sap.ui.getCore().byId("shell-header");K.setModel(L.getModel());var O=sap.ui.getCore().byId("shellAppTitle");if(O){O.setNavigationMenu(K);}i.push(M);return M;}.bind(this));}function n(z){var U=new S({id:"userSettingsBtn",icon:"sap-icon://action-settings",tooltip:r.i18n.getText("userSettings"),text:r.i18n.getText("userSettings"),ariaHaspopup:"dialog",press:z.handleUserSettingsPress});return U.getId();}function o(z){var H=new S({id:"homeBtn",tooltip:r.i18n.getText("homeBtn_tooltip"),ariaLabel:r.i18n.getText("homeBtn_tooltip"),icon:I.getIconURI("home"),target:z.rootIntent?"#"+z.rootIntent:"#"});if(a.last("/core/extension/enableHelp")){H.addStyleClass("help-id-homeBtn",true);}H.addCustomData(new d({key:"aria-disabled",value:"false",writeToDom:true}));if(D.system.desktop){H.addEventDelegate({onsapskipback:function(B){if(f.getAppKeysHandler()){B.preventDefault();f.bFocusOnShell=false;}},onsapskipforward:function(B){if(f.getAppKeysHandler()){B.preventDefault();f.bFocusOnShell=false;}}});}return H.getId();}function p(z){var B=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back";var G=new S({id:"backBtn",tooltip:r.i18n.getText("backBtn_tooltip"),ariaLabel:r.i18n.getText("backBtn_tooltip"),icon:I.getIconURI(B),press:z.pressNavBackButton.bind(z)});return G.getId();}function q(z){var B="meAreaHeaderButton",U=sap.ushell.Container.getUser(),T=r.i18n.getText("MeAreaToggleButtonAria",U.getFullName());var M=new A({id:B,src:"{/userImage/personPlaceHolder}",initials:U.getInitials(),customDisplaySize:"2.25rem",displaySize:h.Custom,tooltip:T,press:function(){E.emit("showMeArea",Date.now());}});if(D.system.desktop){M.addEventDelegate({onsapskipforward:function(G){f.bForwardNavigation=true;G.preventDefault();window.document.getElementById("sapUshellHeaderAccessibilityHelper").focus();}});}M.setModel(z);return B;}function s(z){var B="NotificationsCountButton";var N=new S({id:B,tooltip:r.i18n.getText("notificationsBtn_title"),icon:I.getIconURI("bell"),text:r.i18n.getText("notificationsBtn_title"),ariaLabel:r.i18n.getText("notificationsBtn_title"),enabled:false,ariaHaspopup:"dialog",floatingNumber:"{/notificationsCount}",floatingNumberType:F.Notifications,press:function(){E.emit("showNotifications",Date.now());}});N.setModel(z);N.setModel(r.i18nModel,"i18n");return B;}function t(z,B){var G=new S({id:"endItemsOverflowBtn",tooltip:{path:"/notificationsCount",formatter:function(H){return this.tooltipFormatter(H);}},ariaLabel:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaHaspopup:"dialog",icon:"sap-icon://overflow",floatingNumber:"{/notificationsCount}",floatingNumberType:F.OverflowButton,press:[z.pressEndItemsOverflow,z]});G.setModel(B);return G.getId();}function v(z,B){var O=new S({id:"openCatalogBtn",text:r.i18n.getText("open_appFinderBtn"),tooltip:r.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!z.disableAppFinder,press:B.handleAppFinderPress});if(a.last("/core/extension/enableHelp")){O.addStyleClass("help-id-openCatalogActionItem");}return O.getId();}function w(){var B="ContactSupportBtn",z=sap.ui.getCore().byId(B);if(!z){var T=new b("tempContactSupportBtn",{visible:true});var G=T.getIcon();var H=T.getText();z=new S({id:B,icon:G,tooltip:H,text:H,ariaHaspopup:"dialog",press:function(){T.firePress();}});}return B;}function x(){var B="EndUserFeedbackBtn",z=sap.ui.getCore().byId(B);if(!z){var T=new c("EndUserFeedbackHandlerBtn",{});var G=T.getIcon();var H=T.getText();z=new S({id:B,icon:G,tooltip:H,ariaLabel:H,ariaHaspopup:"dialog",text:H,visible:false});}return z.getId();}function y(){var P=new S({id:"productSwitchBtn",icon:"sap-icon://grid",visible:false,tooltip:r.i18n.getText("productSwitch_tooltip"),text:r.i18n.getText("productSwitch"),ariaHaspopup:"dialog",press:function(){E.emit("showProductSwitch",Date.now());}});return P.getId();}return{init:k,destroy:l};});
