// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/format/DateFormat","sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter"],function(D,C,F,a,S){"use strict";var c={id:"customerCreatedColumnPageId",description:"customerCreatedColumnPageId",title:"customerCreatedColumnPageTitle",createdByFullname:"customerCreatedColumnPageCreated",createdOn:"customerCreatedColumnPageCreated",modifiedByFullname:"customerCreatedColumnPageChanged",modifiedOn:"customerCreatedColumnPageChanged"};return C.extend("sap.ushell.applications.PageComposer.controller.ViewSettingsDialogCustomerCreated",{constructor:function(P){this.PageOverviewController=P;},handleCustomerCreatedDialogConfirm:function(e){var p=e.getParameters(),s=this.PageOverviewController.sCurrentTableId,t=this.PageOverviewController.byId(s),b=t.getBinding("items"),d=this.getSorters(p),f=this.getFilters(p);b.sort(d);this.PageOverviewController.updateSortIndicators(p.sortItem.getKey(),p.sortDescending,c,t.getColumns());this.PageOverviewController.mViewSettingsFilters[this.PageOverviewController.sCurrentTableId]=f;this.PageOverviewController._applyCombinedFilters(f,this.PageOverviewController.mSearchFilter[this.PageOverviewController.sCurrentTableId]);this.PageOverviewController.byId(this.PageOverviewController.sCurrentTableId.slice(0,-5)+"InfoFilterBar").setVisible(!!Object.keys(f).length);this.PageOverviewController.byId(this.PageOverviewController.sCurrentTableId.slice(0,-5)+"InfoFilterLabel").setText(p.filterString);},getSorters:function(p){var s=[new S(p.sortItem.getKey(),p.sortDescending)];var g=p.groupItem;if(g){var G=g.getKey(),f;switch(G){case"createdOnCustomerCreated":case"modifiedOn":f=function(o){var b=D.getInstance({style:"medium"}),d=o.getProperty(G),e=b.format(d);return{key:e,text:e};};break;default:f=function(o){var n=o.getProperty(G);return{key:n,text:n};};}s.push(new S(G,p.groupDescending,f));}return s;},getFilters:function(p){var f={};p.filterItems.forEach(function(i){var P,o,v,V;if(i.getKey()==="createdOn"||i.getKey()==="modifiedOn"){var d=i.getCustomControl();P=i.getKey();o=a.BT;v=d.getDateValue();V=d.getSecondDateValue();if(P==="createdOn"){this._createdOnFromFilter=v;this._createdOnToFilter=V;}else{this._changedOnFromFilter=v;this._changedOnToFilter=V;}}else{var s=i.getKey().split("___");P=s[0];o=s[1];v=s[2];V=s[3];}if(!f[P]){f[P]=[];}f[P].push(new F(P,o,v,V));}.bind(this));return f;},handleCustomerCreatedDateRangeSelectionChanged:function(e){var p=e.getParameters(),v=p.id==="CustomerCreatedCreatedOnDateRangeSelection"?sap.ui.getCore().byId("CustomerCreatedCreatedOnFilter"):sap.ui.getCore().byId("CustomerCreatedChangedOnFilter");if(p.from){v.setFilterCount(1);v.setSelected(true);}else{v.setFilterCount(0);v.setSelected(false);}},handleCustomerCreatedCancel:function(){var o=sap.ui.getCore().byId("CustomerCreatedCreatedOnFilter"),b=sap.ui.getCore().byId("CustomerCreatedCreatedOnDateRangeSelection"),d=sap.ui.getCore().byId("CustomerCreatedChangedOnFilter"),e=sap.ui.getCore().byId("CustomerCreatedChangedOnDateRangeSelection");if(this._createdOnFromFilter){o.setFilterCount(1);o.setSelected(true);}else{o.setFilterCount(0);o.setSelected(false);}if(this._changedOnFromFilter){d.setFilterCount(1);d.setSelected(true);}else{d.setFilterCount(0);d.setSelected(false);}b.setDateValue(this._createdOnFromFilter);b.setSecondDateValue(this._createdOnToFilter);e.setDateValue(this._changedOnFromFilter);e.setSecondDateValue(this._changedOnToFilter);},handleCustomerCreatedResetFilters:function(){var o=sap.ui.getCore().byId("CustomerCreatedCreatedOnDateRangeSelection"),b=sap.ui.getCore().byId("CustomerCreatedChangedOnDateRangeSelection"),d=sap.ui.getCore().byId("CustomerCreatedCreatedOnFilter"),e=sap.ui.getCore().byId("CustomerCreatedChangedOnFilter");o.setDateValue();o.setSecondDateValue();b.setDateValue();b.setSecondDateValue();d.setFilterCount(0);d.setSelected(false);e.setFilterCount(0);e.setSelected(false);}});});
