/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/_internal/flexObjects/Variant","sap/base/Log"],function(V,L){"use strict";var c={addFavorite:function(v){v.setFavorite(true);},removeFavorite:function(v){v.setFavorite(false);}};function g(C){var m={};C.changes.forEach(function(o){var v=o.getContent().key;if(!m[v]){m[v]=[];}m[v].push(o);});return m;}function l(v,C){L.error("No change handler for change with the ID '"+C.getId()+"' and type '"+C.getChangeType()+"' defined.\n"+"The variant '"+v.getId()+"'was not modified'");}function a(p,v){var o={fileName:v.id||"*standard*",content:v.content||{},texts:{variantName:{value:v.name||""}},selector:{persistencyKey:p}};if(v.favorite!==undefined){o.content.favorite=v.favorite;}if(v.executeOnSelect!==undefined){o.content.executeOnSelect=v.executeOnSelect;}return new V(o);}function b(C,v){var s=v.getId();if(C[s]){C[s].forEach(function(o){var d=c[o.getChangeType()]||l;d(v,o);});}}return{merge:function(p,C,s,v){v=v||[];v=v.map(a.bind(undefined,p));v=v.concat(C.variants);var m=g(C);v.forEach(b.bind(undefined,m));if(C.standardVariant){s.content=s.content||{};s.content.executeOnSelect=C.standardVariant.getContent().executeOnSelect;}s.favorite=true;var S=a(p,s);b(m,S);return{standardVariant:S,variants:v};}};});
