/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/Control','sap/ui/base/ManagedObjectObserver','sap/base/util/merge','sap/base/util/deepEqual','sap/ui/mdc/condition/Condition','sap/ui/mdc/condition/FilterOperatorUtil','sap/ui/mdc/condition/Operator','sap/ui/mdc/enum/EditMode','sap/ui/mdc/enum/FieldDisplay','sap/ui/mdc/enum/BaseType','sap/ui/mdc/enum/ConditionValidated','sap/ui/mdc/Field','sap/ui/mdc/field/ListFieldHelp','sap/ui/mdc/field/ListFieldHelpItem','sap/ui/model/base/ManagedObjectModel','sap/ui/model/json/JSONModel','sap/ui/model/resource/ResourceModel','sap/ui/model/type/String','sap/ui/core/library','sap/ui/core/InvisibleText','sap/ui/core/ListItem','sap/ui/layout/Grid','sap/ui/layout/GridData','sap/m/library','sap/m/ScrollContainer','sap/m/Button','sap/m/Panel'],function(C,M,m,d,a,F,O,E,b,B,c,e,L,f,g,J,R,S,h,I,j,G,k,l,n,o,P){"use strict";var p=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");sap.ui.getCore().attachLocalizationChanged(function(){p=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");});var q=l.ButtonType;var V=h.ValueState;var D=C.extend("sap.ui.mdc.field.DefineConditionPanel",{metadata:{library:"sap.ui.mdc",properties:{conditions:{type:"object[]",group:"Data",defaultValue:[],byValue:true},formatOptions:{type:"object",defaultValue:{}},label:{type:"string",defaultValue:""}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},events:{}},_oManagedObjectModel:null,renderer:{apiVersion:2,render:function(i,e1){i.openStart("section",e1);i.class("sapUiMdcDefineConditionPanel");i.openEnd();i.renderControl(e1.getAggregation("_content"));i.close("section");}},init:function(){sap.ui.getCore().getMessageManager().registerObject(this,true);C.prototype.init.apply(this,arguments);this._oManagedObjectModel=new g(this);this._oObserver=new M(_.bind(this));this._oObserver.observe(this,{properties:["conditions","formatOptions"]});K.call(this);this.setModel(this._oManagedObjectModel,"$this");this.setModel(this._oManagedObjectModel,"$condition");},exit:function(){sap.ui.getCore().getMessageManager().unregisterObject(this,true);this._oObserver.disconnect();this._oObserver=undefined;if(this._sConditionsTimer){clearTimeout(this._sConditionsTimer);this._sConditionsTimer=null;}if(this._oDefaultType){this._oDefaultType.destroy();delete this._oDefaultType;}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;},byId:function(i){return sap.ui.getCore().byId(this.getId()+"--"+i);},onBeforeRendering:function(){if(!this.getModel("$i18n")){this.setModel(new R({bundleName:"sap/ui/mdc/messagebundle",async:false}),"$i18n");}if(this.getConditions().length===0){this.updateDefineConditions();}},removeCondition:function(i){var e1=i.oSource;var f1=e1.getBindingContext("$this").getObject();var g1=this.getConditions();var h1=F.indexOfCondition(f1,g1);g1.splice(h1,1);this.setProperty("conditions",g1,true);},addCondition:function(i){var e1=this.getConditions();var f1=this.getFormatOptions();var g1=f1.maxConditions;if(g1===-1||e1.length<g1){this.addDummyCondition(e1.length+1);if(this.getConditions().length===g1){this._bFocusLastCondition=true;}}},addDummyCondition:function(i){var e1=u.call(this);var f1=x.call(this);var g1=z.call(this,f1);var h1=F.getDefaultOperator(g1);var i1=e1.indexOf(h1.name)>=0?h1.name:e1[0];var j1=a.createCondition(i1,[null],undefined,undefined,c.NotValidated);F.updateConditionValues(j1);F.checkConditionsEmpty(j1,e1);var k1=this.getConditions();if(i!==undefined){k1.splice(i,0,j1);}else{k1.push(j1);}this.setProperty("conditions",k1,true);},updateDefineConditions:function(){var i=this.getConditions().filter(function(e1){return e1.validated!==c.Validated;});H.call(this,i,true,false);if(i.length===0){this.addDummyCondition();}},onChange:function(i){var e1=u.call(this);var f1=this.getConditions();F.checkConditionsEmpty(f1,e1);F.updateConditionsValues(f1,e1);this.setProperty("conditions",f1,true);},onSelectChange:function(i){var e1=i.getSource();var f1=e1.getValue();var g1=e1._sOldKey;var h1=F.getOperator(f1);var i1=g1&&F.getOperator(g1);if(h1&&i1){var j1;var k1;var l1;var m1=false;if(!d(h1.valueTypes[0],i1.valueTypes[0])&&h1.valueTypes[0]!==O.ValueType.Static){j1=e1.getBindingContext("$this").getObject();k1=this.getConditions();l1=F.indexOfCondition(j1,k1);if(l1>=0){j1=k1[l1];if(j1.values.length>0&&j1.values[0]!==null){j1.values[0]=null;m1=true;}if(j1.values.length>1&&j1.values[1]!==null){j1.values[1]=null;m1=true;}}}if(!h1.valueTypes[1]&&i1.valueTypes[1]){if(!j1){j1=e1.getBindingContext("$this").getObject();k1=this.getConditions();l1=F.indexOfCondition(j1,k1);j1=k1[l1];}if(l1>=0){if(j1.values.length>1&&j1.values[1]){j1.values=j1.values.slice(0,1);m1=true;}}}if(m1){this.setProperty("conditions",k1,true);}}delete e1._sOldKey;},onPaste:function(e1){var f1;var g1=e1.srcControl;var h1=this.getFormatOptions();var i1=h1.hasOwnProperty("maxConditions")?h1.maxConditions:-1;var j1=g1.getBindingContext("$condition").getPath();var k1=parseInt(j1.split("/")[2]);if(window.clipboardData){f1=window.clipboardData.getData("Text");}else{f1=e1.originalEvent.clipboardData.getData('text/plain');}var l1=f1.split(/\r\n|\r|\n/g);if(l1&&l1.length>1){setTimeout(function(){var m1=x.call(this);var n1=z.call(this,m1);var o1=l1.length;var p1=this.getConditions();for(var i=0;i<o1;i++){if(l1[i]){var q1=l1[i];var r1=q1.split(/\t/g);var s1;if(r1.length==2&&r1[0]&&r1[1]){s1=F.getOperator("BT");}else{r1=[q1.trim()];s1=F.getDefaultOperator(n1);}q1=s1?s1.format(a.createCondition(s1.name,r1)):r1[0];if(s1){var t1=s1.getCondition(q1,m1,b.Value,true);if(t1){t1.validated=c.NotValidated;if(p1.length>k1){p1.splice(k1,1,t1);}else{p1.push(t1);}k1++;}}}}if(i1>=0&&p1.length>i1){p1.splice(i1,p1.length-i1);}if(g1.setDOMValue){g1.setDOMValue("");}F.checkConditionsEmpty(p1);this.setProperty("conditions",p1,true);}.bind(this),0);}},cleanUp:function(){var e1=this.byId("conditions");var f1=e1.getContent();for(var i=0;i<f1.length;i++){var g1=f1[i];if(g1 instanceof e&&g1.hasOwnProperty("_iValueIndex")){if(g1._bParseError){g1.setValue();}if(g1.getValueState()!==V.None){g1.setValueState(V.None);g1.setValueStateText();}}}}});function _(i){if(i.name==="value"){r.call(this,i.object,i.current,i.old);}if(i.name==="formatOptions"){var e1=this.getConditions();var f1=i.current&&i.current.operators;var g1=i.old&&i.old.operators;var h1=false;if(!d(f1,g1)){h1=true;w.call(this);}var i1=i.current&&i.current.valueType&&i.current.valueType.getMetadata().getName();var j1=i.old&&i.old.valueType&&i.old.valueType.getMetadata().getName();if(i1!==j1&&e1.length>0){if(!h1){w.call(this);}this._bUpdateType=true;T.call(this);this._bUpdateType=false;H.call(this,e1,true,true);}}if(i.name==="conditions"){if(this._sConditionsTimer){clearTimeout(this._sConditionsTimer);this._sConditionsTimer=null;}this._sConditionsTimer=setTimeout(function(){this._sConditionsTimer=null;this.updateDefineConditions();T.call(this);}.bind(this),0);}}function r(e1,f1,g1){e1._sOldKey=g1;var h1=0;if(f1&&g1){var i1=F.getOperator(f1);var j1=F.getOperator(g1);var k1=e1.getParent();var l1;var m1;h1=k1.indexOfContent(e1);l1=k1.getContent()[h1+2];if(l1&&l1.hasOwnProperty("_iValueIndex")&&l1._iValueIndex===0){if(l1 instanceof e&&!l1._bParseError){l1.setValueState(V.None);l1.setValueStateText();}m1=k1.getContent()[h1+3];if(m1&&m1.hasOwnProperty("_iValueIndex")&&m1._iValueIndex===1){if(m1 instanceof e&&!m1._bParseError){m1.setValueState(V.None);m1.setValueStateText();}}else{m1=undefined;}}else{l1=undefined;}if(i1.createControl||j1.createControl){if(l1){l1.destroy();}if(m1){m1.destroy();}}else{if(l1&&i1.valueTypes[0]!==j1.valueTypes[0]){l1.unbindProperty("value");}if(m1&&i1.valueTypes[1]!==j1.valueTypes[1]&&j1.valueTypes[1]){m1.unbindProperty("value");}}}if(!f1){var n1=e1.getBindingContext("$this").getObject();if(n1){var o1=this.getConditions();h1=F.indexOfCondition(n1,o1);if(h1>=0){n1=o1[h1];n1.operator=g1;this.setProperty("conditions",o1,true);}}}var p1=this.oOperatorModel.getData();var q1;for(var i=0;i<p1.length;i++){var r1=p1[i];if(r1.key===f1){q1=r1.additionalText;break;}}e1.setAdditionalValue(q1);this.onChange();}function s(i,e1,f1,g1){var h1=F.getOperator(i.operator);if(!h1){return null;}var i1=t.call(this,h1.name,e1);var j1=this._oManagedObjectModel.getContext(g1.getPath()+"values/"+e1+"/");var k1;if(h1.createControl){k1=h1.createControl(i1,"$this>",e1,f1);}else{k1=new e(f1,{delegate:A.call(this),value:{path:"$this>",type:i1,mode:'TwoWay',targetType:'raw'},editMode:{path:"$condition>operator",formatter:W},width:"100%"});}if(k1.getMetadata().hasProperty("placeholder")){if(e1===0){k1.bindProperty("placeholder",{path:"$condition>operator",formatter:$});}else{k1.bindProperty("placeholder",{path:"$condition>operator",formatter:a1});}}k1._iValueIndex=e1;if(k1.attachChange){k1.attachChange(this.onChange.bind(this));}k1.onpaste=this.onPaste.bind(this);k1.setLayoutData(new k({span:{path:"$condition>",formatter:Z.bind(this)}}));k1.setBindingContext(j1,"$this");k1.setBindingContext(g1,"$condition");k1.setFieldGroupIds([g1.getPath()]);return k1;}function t(i,e1){var f1=x.call(this);var g1=F.getOperator(i);if(g1.valueTypes[e1]&&[O.ValueType.Self,O.ValueType.Static].indexOf(g1.valueTypes[e1])===-1){f1=g1._createLocalType(g1.valueTypes[e1],f1);}var h1=false;if(g1.valueTypes[e1]===O.ValueType.Static){h1=true;f1=y.call(this);}var i1=h1?B.String:z.call(this,f1);var j1;var k1;var l1;var m1;switch(i1){case B.Boolean:if(f1.oConstraints&&f1.oConstraints.hasOwnProperty("nullable")&&f1.oConstraints.nullable===false){k1=sap.ui.require(f1.getMetadata().getName().replace(/\./g,"/"));l1=m({},f1.oFormatOptions);m1=m(f1.oConstraints,{nullable:true});j1=new k1(l1,m1);}else{j1=f1;}break;case B.Numeric:if(f1.oFormatOptions&&f1.oFormatOptions.hasOwnProperty("emptyString")&&f1.oFormatOptions.emptyString===null){j1=f1;}else{k1=sap.ui.require(f1.getMetadata().getName().replace(/\./g,"/"));l1=m(f1.oFormatOptions,{emptyString:null});j1=new k1(l1,f1.oConstraints);}break;case B.Date:case B.Time:case B.DateTime:j1=f1;break;default:j1=f1;break;}return j1;}function u(){var i=this.getFormatOptions();var e1=i&&i.operators;if(!e1||e1.length===0){e1=F.getOperatorsForType(B.String);}return e1;}function v(){var e1;var f1=u.call(this);for(var i=0;i<f1.length;i++){var g1=f1[i];var h1=F.getOperator(g1);if(!e1){e1=h1.group.id;}else if(e1!==h1.group.id){return true;}}return false;}function w(){if(!this.oOperatorModel){return;}var e1=x.call(this);var f1=u.call(this);var g1=[];var h1=v.call(this);var i1=this.getId()+"--rowSelect-help";var j1=sap.ui.getCore().byId(i1);var k1;if(h1){k1=new f({key:"{om>key}",text:"{om>text}",additionalText:"{om>additionalText}",groupKey:"{om>groupId}",groupText:"{om>groupText}"});}else{k1=new j({key:"{om>key}",text:"{om>text}",additionalText:"{om>additionalText}"});}j1.bindAggregation("items",{path:'om>/',templateShareable:false,template:k1});for(var i=0;i<f1.length;i++){var l1=f1[i];var m1=F.getOperator(l1);if(!m1||(m1.showInSuggest!==undefined&&m1.showInSuggest==false)){continue;}var n1=m1.textKey||"operators."+m1.name+".longText";var o1=m1.getTypeText(n1,e1.getName().toLowerCase());if(o1===n1){o1=m1.longText;}var p1=m1.additionalInfo;if(p1===undefined){if(p1!==""&&m1.formatRange){p1=m1.formatRange(m1._getRange(undefined,e1),e1);}else if(!h1){p1=m1.group.text;}}g1.push({key:m1.name,text:o1,additionalText:p1,groupId:m1.group.id,groupText:m1.group.text});}this.oOperatorModel.setData(g1);}function x(){var i=this.getFormatOptions();var e1=i&&i.valueType;if(!e1){e1=y.call(this);}return e1;}function y(){if(!this._oDefaultType){this._oDefaultType=new S();}return this._oDefaultType;}function z(i){var e1=i.getMetadata().getName();var f1=i.oFormatOptions;var g1=i.oConstraints;var h1=this.getFormatOptions().delegate;var i1=this.getFormatOptions().payload;var j1=h1?h1.getTypeUtil(i1).getBaseType(e1,f1,g1):B.String;if(j1===B.Unit){j1=B.Numeric;}return j1;}function A(){var i=this.getFormatOptions();var e1=i.delegateName||"sap/ui/mdc/field/FieldBaseDelegate";var f1=i.payload;return{name:e1,payload:f1};}function H(e1,f1,g1){var h1=x.call(this);var i1=[];var i=0;for(i=0;i<e1.length;i++){var j1=e1[i];var k1=F.getOperator(j1.operator);if(k1&&k1.valueTypes[0]===O.ValueType.Static&&(j1.values.length===0||g1)){if(k1.getStaticText){var l1=k1.getStaticText(h1);if(j1.values.length>0){j1.values[0]=l1;}else{j1.values.push(l1);}i1.push(i);}}}if(i1.length>0){this.setProperty("conditions",e1,true);}}function K(){var i=new I(this.getId()+"--ivtOperator",{text:"{$i18n>valuehelp.DEFINECONDITIONS_OPERATORLABEL}"});var e1=new P({headerText:"{$this>/label}",expanded:true,height:"100%",backgroundDesign:"Transparent"}).addStyleClass("sapMdcDefineconditionPanel");e1.addDependent(new L(this.getId()+"--rowSelect-help",{filterList:false,useFirstMatch:true}));var f1=new G(this.getId()+"--conditions",{width:"100%",hSpacing:0,vSpacing:0,containerQuery:true}).addStyleClass("sapUiMdcDefineConditionGrid");U.call(this,undefined,f1,0,null,0);e1.addContent(i);e1.addContent(f1);var g1=new o(this.getId()+"--addBtn",{press:this.addCondition.bind(this),type:q.Default,text:"{$i18n>valuehelp.DEFINECONDITIONS_ADDCONDITION}",layoutData:new k({span:"XL2 L3 M3 S3",indent:"XL9 L8 M8 S7",linebreak:true,visibleS:{path:"$this>/conditions",formatter:N.bind(this)},visibleM:{path:"$this>/conditions",formatter:N.bind(this)},visibleL:{path:"$this>/conditions",formatter:N.bind(this)},visibleXL:{path:"$this>/conditions",formatter:N.bind(this)}})});f1.addContent(g1);f1.attachValidateFieldGroup(c1,this);this.setAggregation("_content",e1);}function N(i){var e1=this.getFormatOptions();var f1=e1.hasOwnProperty("maxConditions")?e1.maxConditions:-1;return f1===-1||i.length<f1;}function Q(i){var e1=this.getFormatOptions();var f1=e1.hasOwnProperty("maxConditions")?e1.maxConditions:-1;return f1!==1;}function T(){var e1=this.getConditions();var f1=this.byId("conditions");var g1;var h1=-1;var i1=0;for(var i=0;i<e1.length;i++){var j1=e1[i];if(j1.validated!==c.Validated){var k1=this._oManagedObjectModel.getContext("/conditions/"+i+"/");h1++;if(!this.oOperatorModel){this.oOperatorModel=new J();this.setModel(this.oOperatorModel,"om");w.call(this);}g1=f1.getContent();if(g1[i1]&&g1[i1].isA("sap.ui.mdc.Field")){i1=b1.call(this,j1,f1,i1,k1,h1);}else{i1=U.call(this,j1,f1,i1,k1,h1);}}}g1=f1.getContent();while(g1[i1]&&g1[i1]!==this.byId("addBtn")){g1[i1].destroy();i1++;}if(this._bFocusLastCondition){g1[0].focus();this._bFocusLastCondition=false;}}function U(e1,f1,g1,h1,i1){var j1=this.getId()+"--"+i1;if(!this._oOperatorFieldType){this._oOperatorFieldType=new S({},{minLength:1});}var k1=new e(j1+"-operator",{value:{path:"$this>operator",type:this._oOperatorFieldType},width:"100%",display:"Description",fieldHelp:this.getId()+"--rowSelect-help",change:this.onSelectChange.bind(this),ariaLabelledBy:this.getId()+"--ivtOperator"}).setLayoutData(new k({span:{path:"$this>/conditions",formatter:Y.bind(this)},linebreak:true})).setBindingContext(h1,"$this");if(h1){k1.setFieldGroupIds([h1.getPath()]);}this._oObserver.observe(k1,{properties:["value"]});f1.insertContent(k1,g1);g1++;var l1=new o(j1+"--removeBtnSmall",{press:this.removeCondition.bind(this),type:q.Transparent,icon:"sap-icon://decline",tooltip:"{$i18n>valuehelp.DEFINECONDITIONS_REMOVECONDITION}"}).setLayoutData(new k({span:"XL1 L1 M1 S2",indent:{path:"$this>operator",formatter:X},visibleS:{path:"$this>/conditions",formatter:Q.bind(this)},visibleM:false,visibleL:false,visibleXL:false})).setBindingContext(h1,"$this");if(h1){l1.setFieldGroupIds([h1.getPath()]);}f1.insertContent(l1,g1);g1++;if(e1){for(var i=0;i<e1.values.length;i++){var m1=s.call(this,e1,i,j1+"-values"+i,h1);if(m1){f1.insertContent(m1,g1);g1++;}}}var n1=new o(j1+"--removeBtnLarge",{press:this.removeCondition.bind(this),type:q.Transparent,icon:"sap-icon://decline",tooltip:"{$i18n>valuehelp.DEFINECONDITIONS_REMOVECONDITION}"}).setLayoutData(new k({span:"XL1 L1 M1 S1",indent:{path:"$this>operator",formatter:X},visibleS:false,visibleM:{path:"$this>/conditions",formatter:Q.bind(this)},visibleL:{path:"$this>/conditions",formatter:Q.bind(this)},visibleXL:{path:"$this>/conditions",formatter:Q.bind(this)}})).setBindingContext(h1,"$this");f1.insertContent(n1,g1);g1++;return g1;}function W(i){if(!i){return E.Display;}var e1=F.getOperator(i);var f1=false;if(e1&&e1.valueTypes[0]===O.ValueType.Static){f1=true;}return f1?E.Display:E.Editable;}function X(i){var e1=i&&F.getOperator(i);if(!e1||!e1.valueTypes[0]){return"XL8 L8 M8 S0";}else{return"";}}function Y(i){var e1=this.getFormatOptions();var f1=e1.hasOwnProperty("maxConditions")?e1.maxConditions:-1;var g1="XL3 L3 M3 ";if(f1===1){g1+="S12";}else{g1+="S10";}return g1;}function Z(i){var e1=this.getFormatOptions();var f1=e1.hasOwnProperty("maxConditions")?e1.maxConditions:-1;var g1=i&&F.getOperator(i.operator);var h1="";if(g1&&g1.valueTypes[1]){h1="XL4 L4 M4 ";}else{h1="XL8 L8 M8 ";}if(f1===1){h1+="S12";}else{h1+="S10";}return h1;}function $(i){var e1=i&&F.getOperator(i);if(e1&&e1.aLabels){return e1.aLabels[0];}else if(e1&&e1.valueTypes[1]){return p.getText("valuehelp.DEFINECONDITIONS_FROM");}else{return p.getText("valuehelp.DEFINECONDITIONS_VALUE");}}function a1(i){var e1=i&&F.getOperator(i);if(e1&&e1.aLabels){return e1.aLabels[1];}else if(e1&&e1.valueTypes[1]){return p.getText("valuehelp.DEFINECONDITIONS_TO");}}function b1(e1,f1,g1,h1,i1){var j1=this.getId()+"--"+i1;var k1=f1.getContent();var l1;var m1=k1[g1];m1.setBindingContext(h1,"$this");if(h1){m1.setFieldGroupIds([h1.getPath()]);}g1++;var n1=k1[g1];n1.setBindingContext(h1,"$this");if(h1){n1.setFieldGroupIds([h1.getPath()]);}g1++;var o1;var p1=k1[g1];var q1;if(p1.hasOwnProperty("_iValueIndex")&&p1._iValueIndex===0){var r1=W(e1.operator);if(e1.values.length>0||r1===E.Display){o1=this._oManagedObjectModel.getContext(h1.getPath()+"values/0/");p1.setBindingContext(o1,"$this");p1.setBindingContext(h1,"$condition");if(p1.getMetadata().hasProperty("value")&&(this._bUpdateType||!p1.getBindingInfo("value"))){l1=t.call(this,e1.operator,0);p1.bindProperty("value",{path:"$this>",type:l1});}g1++;q1=k1[g1];if(q1.hasOwnProperty("_iValueIndex")&&q1._iValueIndex===1){if(e1.values.length>1){o1=this._oManagedObjectModel.getContext(h1.getPath()+"values/1/");q1.setBindingContext(o1,"$this");if(q1.getMetadata().hasProperty("value")&&(this._bUpdateType||!q1.getBindingInfo("value"))){l1=t.call(this,e1.operator,1);q1.bindProperty("value",{path:"$this>",type:l1});}g1++;}else{q1.destroy();}}else if(e1.values.length>1){q1=s.call(this,e1,1,j1+"-values1",h1);if(q1){f1.insertContent(q1,g1);g1++;}}}else{p1.destroy();p1=undefined;q1=k1[g1+1];if(q1&&q1.hasOwnProperty("_iValueIndex")&&q1._iValueIndex===1){q1.destroy();}}}else if(e1.values.length>0){for(var i=0;i<e1.values.length;i++){var s1=s.call(this,e1,i,j1+"-values"+i,h1);if(s1){f1.insertContent(s1,g1);g1++;}}}k1=f1.getContent();var t1=k1[g1];t1.setBindingContext(h1,"$this");g1++;return g1;}function c1(i){var e1=i.getSource();while(!(e1.getParent()instanceof G)){e1=e1.getParent();}d1.call(this,e1);}function d1(i){var e1=i.getParent();var f1=e1.indexOfContent(i);var g1;if(i.getId().endsWith("-operator")){g1=i.getBindingContext("$this");f1=f1+2;i=e1.getContent()[f1];}else{g1=i.getBindingContext("$condition");}var h1;var i1=g1.getObject();var j1=F.getOperator(i1.operator);if(j1.valueTypes.length>0&&j1.valueTypes[0]!==O.ValueType.Static){if(j1.valueTypes.length>1&&j1.valueTypes[1]){if(i.hasOwnProperty("_iValueIndex")&&i._iValueIndex===0){h1=e1.getContent()[f1+1];}else if(i.hasOwnProperty("_iValueIndex")&&i._iValueIndex===1){h1=e1.getContent()[f1-1];}}if(i.getMetadata().getAllProperties().valueState&&!i._bParseError&&(!h1||!h1._bParseError)){try{j1.validate(i1.values,x.call(this));i.setValueState(V.None);i.setValueStateText();if(h1&&h1.getMetadata().getAllProperties().valueState){h1.setValueState(V.None);h1.setValueStateText();}}catch(k1){i.setValueState(V.Error);i.setValueStateText(k1.message);if(h1&&h1.getMetadata().getAllProperties().valueState){h1.setValueState(V.Error);h1.setValueStateText(k1.message);}}}}}return D;});
