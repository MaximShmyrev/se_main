/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../controls/ActionsToolbar","sap/ui/base/Interface","sap/ui/thirdparty/jquery","sap/ui/core/Core","sap/ui/integration/util/Manifest","sap/ui/integration/util/ServiceManager","sap/base/Log","sap/base/util/merge","sap/base/util/deepEqual","sap/base/util/isPlainObject","sap/ui/integration/util/DataProviderFactory","sap/m/HBox","sap/ui/core/Icon","sap/m/Text","sap/ui/model/json/JSONModel","sap/ui/integration/model/ObservableModel","sap/ui/model/resource/ResourceModel","sap/ui/integration/model/ContextModel","sap/base/util/LoaderExtensions","sap/f/CardRenderer","sap/f/CardBase","sap/f/library","sap/ui/integration/library","sap/ui/integration/util/Destinations","sap/ui/integration/util/LoadingProvider","sap/ui/integration/util/HeaderFactory","sap/ui/integration/util/ContentFactory","sap/ui/integration/util/BindingResolver","sap/ui/integration/formatters/IconFormatter","sap/ui/integration/util/FilterBarFactory","sap/ui/integration/util/CardActions"],function(A,I,q,C,a,S,L,m,d,i,D,H,b,T,J,O,R,c,f,F,g,l,h,j,k,n,o,B,p,r,s){"use strict";var M={TYPE:"/sap.card/type",DATA:"/sap.card/data",HEADER:"/sap.card/header",HEADER_POSITION:"/sap.card/headerPosition",CONTENT:"/sap.card/content",SERVICES:"/sap.ui5/services",APP_TYPE:"/sap.app/type",PARAMS:"/sap.card/configuration/parameters",DESTINATIONS:"/sap.card/configuration/destinations",FILTERS:"/sap.card/configuration/filters"};var t=["parameters","filters","context","i18n"];var u=l.cards.HeaderPosition;var v=h.CardDataMode;var w="Card is destroyed!";var x=h.CardArea;var y=g.extend("sap.ui.integration.widgets.Card",{metadata:{library:"sap.ui.integration",properties:{manifest:{type:"any",defaultValue:""},parameters:{type:"object",defaultValue:null},dataMode:{type:"sap.ui.integration.CardDataMode",group:"Behavior",defaultValue:v.Active},baseUrl:{type:"sap.ui.core.URI",defaultValue:null},manifestChanges:{type:"object[]"}},aggregations:{actionDefinitions:{type:"sap.ui.integration.ActionDefinition",multiple:true,forwarding:{getter:"_getActionsToolbar",aggregation:"actionDefinitions"}},_header:{type:"sap.f.cards.IHeader",multiple:false,visibility:"hidden"},_filterBar:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_extension:{type:"sap.ui.integration.Extension",multiple:false,visibility:"hidden"},_loadingProvider:{type:"sap.ui.core.Element",multiple:false,visibility:"hidden"}},events:{action:{allowPreventDefault:true,parameters:{actionSource:{type:"sap.ui.core.Control"},manifestParameters:{type:"object"},parameters:{type:"object"},type:{type:"sap.ui.integration.CardActionType"}}},manifestReady:{},manifestApplied:{}},associations:{host:{}}},renderer:F});y.prototype.init=function(){g.prototype.init.call(this);this.setAggregation("_loadingProvider",new k());this.setModel(new J(),"parameters");this.setModel(new J(),"filters");this.setModel(new c(),"context");this._busyStates=new Map();this._oContentFactory=new o(this);this._oLimitedInterface=new I(this,["getParameters","getCombinedParameters","getManifestEntry","resolveDestination","request","showMessage","getBaseUrl","getTranslatedText","getModel","triggerAction","addActionDefinition","removeActionDefinition","insertActionDefinition","getActionDefinition","indexOfActionDefinition","destroyActionDefinition","showLoadingPlaceholders","hideLoadingPlaceholders"]);};y.prototype._initReadyState=function(){this._aReadyPromises=[];this._awaitEvent("_headerReady");this._awaitEvent("_filterBarReady");this._awaitEvent("_contentReady");this._awaitEvent("_cardReady");Promise.all(this._aReadyPromises).then(function(){this._bReady=true;this.fireEvent("_ready");}.bind(this));};y.prototype._clearReadyState=function(){this._bReady=false;this._aReadyPromises=[];};y.prototype.onBeforeRendering=function(){if(this.getDataMode()!==v.Active){return;}this.startManifestProcessing();};y.prototype.startManifestProcessing=function(){if(this._bApplyManifest||this._bApplyParameters){this._clearReadyState();this._initReadyState();}if(this._bApplyManifest){var e=this.getManifest();if(!e){this.destroyManifest();}else{this.createManifest(e,this.getBaseUrl());}}if(!this._bApplyManifest&&this._bApplyParameters){this._oCardManifest.processParameters(this._getContextAndRuntimeParams());this._applyManifestSettings();}this._bApplyManifest=false;this._bApplyParameters=false;this._refreshActionsMenu();};y.prototype.setManifest=function(V){this.setProperty("manifest",V);this.destroyActionDefinitions();this._bApplyManifest=true;return this;};y.prototype.setManifestChanges=function(V){this.setProperty("manifestChanges",V);this._bApplyManifest=true;return this;};y.prototype.setParameters=function(V){this.setProperty("parameters",V);this._bApplyParameters=true;return this;};y.prototype.setParameter=function(K,V){var P=this.getParameters()||{};P[K]=V;this.setParameters(P);return this;};y.prototype.setHost=function(e){this.setAssociation("host",e);var z=this.getHostInstance();this.getModel("context").setHost(z);if(this._oDestinations){this._oDestinations.setHost(z);}return this;};y.prototype.createManifest=function(z,E){var G={};this._isManifestReady=false;if(typeof z==="string"){G.manifestUrl=z;z=null;}if(this._oCardManifest){this._oCardManifest.destroy();}this.destroyAggregation("_extension");this._oCardManifest=new a("sap.card",z,E,this.getManifestChanges());this._oCardManifest.load(G).then(function(){if(this.bIsDestroyed){throw new Error(w);}this._registerManifestModulePath();this._isManifestReady=true;this.fireManifestReady();return this._loadExtension();}.bind(this)).then(this._applyManifest.bind(this)).catch(function(e){if(e.message!==w){this._applyManifest();}}.bind(this));};y.prototype._loadExtension=function(){var e=this._oCardManifest.get("/sap.card/extension");if(!e){return null;}var z=this._oCardManifest.get("/sap.app/id").replace(/\./g,"/")+"/"+e;return new Promise(function(E,G){sap.ui.require([z],function(K){var N=new K();N._setCard(this,this._oLimitedInterface);this.setAggregation("_extension",N);E();}.bind(this),function(K){L.error("Failed to load "+e+". Check if the path is correct. Reason: "+K);G(K);});}.bind(this));};y.prototype._applyManifest=function(){var e=this._oCardManifest;if(e&&e.getResourceBundle()){this._enhanceI18nModel(e.getResourceBundle());}this.getModel("context").resetHostProperties();if(this._hasContextParams()){this._resolveContextParams().then(function(z){this._oContextParameters=z;this._applyManifestWithParams();}.bind(this));return;}this._applyManifestWithParams();};y.prototype._applyManifestWithParams=function(){var e=this._oCardManifest,P=this._getContextAndRuntimeParams();e.processParameters(P);this._prepareToApplyManifestSettings();this._applyManifestSettings();};y.prototype._loadDefaultTranslations=function(){if(this._defaultTranslationsLoaded){return;}var e=C.getLibraryResourceBundle("sap.ui.integration");this._enhanceI18nModel(e);this._defaultTranslationsLoaded=true;};y.prototype._enhanceI18nModel=function(e){var z=this.getModel("i18n");if(z){z.enhance(e);return;}z=new R({bundle:e});this.setModel(z,"i18n");};y.prototype._hasContextParams=function(){var e=this._oCardManifest.get(M.PARAMS),K,V;for(K in e){V=e[K].value;if(typeof V==="string"&&V.indexOf("{context>")!==-1){return true;}}return false;};y.prototype._resolveContextParams=function(){var e=this.getModel("context"),z=this._oCardManifest.get(M.PARAMS),E={},K,V;for(K in z){V=z[K].value;if(typeof V==="string"&&V.indexOf("{context>")!==-1){E[K]=V;}}B.resolveValue(E,this,"/");return e.waitForPendingProperties().then(function(){return B.resolveValue(E,this,"/");}.bind(this));};y.prototype._getContextAndRuntimeParams=function(){var e=this._oContextParameters||{},z=this.getParameters()||{};return m(e,z);};y.prototype._awaitEvent=function(e){this._aReadyPromises.push(new Promise(function(z){this.attachEventOnce(e,function(){z();});}.bind(this)));};y.prototype.isReady=function(){return this._bReady;};y.prototype.refresh=function(){if(this.getDataMode()===v.Active){this._bApplyManifest=true;this.invalidate();}};y.prototype._refreshActionsMenu=function(){var e=this.getCardHeader(),z=this.getHostInstance(),E=this.getAggregation("_extension"),G=[];if(!e){return;}if(z){G=G.concat(z.getActions()||[]);}if(E){G=G.concat(E.getActions()||[]);}if(d(G,this._getActionsToolbar()._aActions)){return;}this._getActionsToolbar().initializeContent(this);};y.prototype.exit=function(){g.prototype.exit.call(this);this.destroyManifest();this._busyStates=null;this._oContentFactory=null;if(this._oActionsToolbar){this._oActionsToolbar.destroy();this._oActionsToolbar=null;}};y.prototype.destroyManifest=function(){if(this._oCardManifest){this._oCardManifest.destroy();this._oCardManifest=null;}if(this._oServiceManager){this._oServiceManager.destroy();this._oServiceManager=null;}if(this._oDataProviderFactory){this._oDataProviderFactory.destroy();this._oDataProviderFactory=null;this._oDataProvider=null;}if(this._oTemporaryContent){this._oTemporaryContent.destroy();this._oTemporaryContent=null;}if(this._oDestinations){this._oDestinations.destroy();this._oDestinations=null;}if(this._oIconFormatter){this._oIconFormatter.destroy();this._oIconFormatter=null;}this.destroyAggregation("_header");this.destroyAggregation("_filterBar");this.destroyAggregation("_content");this._aReadyPromises=null;this._busyStates.clear();this.getModel("filters").setData({});this._oContextParameters=null;this._deregisterCustomModels();};y.prototype._registerManifestModulePath=function(){if(!this._oCardManifest){return;}this._sAppId=this._oCardManifest.get("/sap.app/id");if(this._sAppId){f.registerResourcePath(this._sAppId.replace(/\./g,"/"),this._oCardManifest.getUrl());}else{L.error("Card sap.app/id entry in the manifest is mandatory");}};y.prototype.getManifest=function(){var V=this.getProperty("manifest");if(V&&typeof V==="object"){return q.extend(true,{},V);}return V;};y.prototype.getParameters=function(){var V=this.getProperty("parameters");if(V&&typeof V==="object"){return q.extend(true,{},V);}return V;};y.prototype.getCombinedParameters=function(){if(!this._isManifestReady){L.error("The manifest is not ready. Consider using the 'manifestReady' event.","sap.ui.integration.widgets.Card");return null;}var P=this._oCardManifest.getProcessedParameters(this._getContextAndRuntimeParams()),e={},K;for(K in P){e[K]=P[K].value;}return e;};y.prototype.getManifestEntry=function(P){if(!this._isManifestReady){L.error("The manifest is not ready. Consider using the 'manifestReady' event.","sap.ui.integration.widgets.Card");return null;}return this._oCardManifest.get(P);};y.prototype.getManifestRawJson=function(){if(!this._oCardManifest||!this._oCardManifest){L.error("The manifest is not ready. Consider using the 'manifestReady' event.","sap.ui.integration.widgets.Card");return{};}return this._oCardManifest.getInitialJson();};y.prototype.getManifestWithMergedChanges=function(){if(!this._oCardManifest||!this._oCardManifest._oManifest){L.error("The manifest is not ready. Consider using the 'manifestReady' event.","sap.ui.integration.widgets.Card");return{};}return q.extend(true,{},this._oCardManifest._oManifest.getRawJson());};y.prototype.resolveDestination=function(K){return this._oDestinations.getUrl(K);};y.prototype.showMessage=function(e,z){var E=this.getCardContent();if(!E||!E.showMessage){L.error("The experimental feature 'showMessage' is currently available only for an Adaptive Card.");return;}E.showMessage(e,z);};y.prototype.getTranslatedText=function(K,e,z){var E=this.getModel("i18n"),G;if(!E){L.warning("There are no translations available. Either the i18n configuration is missing or the method is called too early.");return null;}G=E.getResourceBundle();return G.getText(K,e,z);};y.prototype.getDataProviderFactory=function(){if(!this._oDataProviderFactory){L.error("The DataProviderFactory instance is not ready yet. Consider using the event 'manifestApplied'.","sap.ui.integration.widgets.Card");return null;}return this._oDataProviderFactory;};y.prototype.getRuntimeUrl=function(U){var e=this._sAppId,z,E=U&&U.trim().replace(/^\//,"");if(e===null){L.error("The manifest is not ready so the URL can not be resolved. Consider using the 'manifestReady' event.","sap.ui.integration.widgets.Card");return null;}if(!e||U.startsWith("http://")||U.startsWith("https://")||U.startsWith("//")){return U;}z=e.replace(/\./g,"/");return sap.ui.require.toUrl(z)+"/"+E;};y.prototype._prepareToApplyManifestSettings=function(){var e=this._oCardManifest.get(M.APP_TYPE),E=this.getAggregation("_extension");if(e&&e!=="card"){L.error("sap.app/type entry in manifest is not 'card'");}if(this._oDataProviderFactory){this._oDataProviderFactory.destroy();}this._oDestinations=new j(this.getHostInstance(),this._oCardManifest.get(M.DESTINATIONS));this._oIconFormatter=new p({destinations:this._oDestinations,card:this});this._oDataProviderFactory=new D(this._oDestinations,E,this);this._registerCustomModels();if(E){E.onCardReady();}this._fillFiltersModel();};y.prototype._fillFiltersModel=function(){var e=this.getModel("filters"),z=this._oCardManifest.get(M.FILTERS);for(var K in z){e.setProperty("/"+K,{"value":z[K].value});}};y.prototype._applyManifestSettings=function(){this._applyServiceManifestSettings();this._applyFilterBarManifestSettings();this._applyDataManifestSettings();this._applyHeaderManifestSettings();this._applyContentManifestSettings();this.fireManifestApplied();};y.prototype._applyDataManifestSettings=function(){var e=this._oCardManifest.get(M.DATA),z;if(!e){this.fireEvent("_cardReady");return;}this.bindObject(e.path||"/");if(this._oDataProvider){this._oDataProvider.destroy();}this._oDataProvider=this._oDataProviderFactory.create(e,this._oServiceManager);this.getAggregation("_loadingProvider").setDataProvider(this._oDataProvider);if(e.name){z=this.getModel(e.name);}else if(this._oDataProvider){z=new O();this.setModel(z);}if(!z){this.fireEvent("_cardReady");return;}z.attachEvent("change",function(){if(this._createContentPromise){this._createContentPromise.then(function(E){E.onDataChanged();this.onDataRequestComplete();}.bind(this));}else{this.onDataRequestComplete();}}.bind(this));if(this._oDataProvider){this._oDataProvider.attachDataRequested(function(){this._showLoadingPlaceholders();}.bind(this));this._oDataProvider.attachDataChanged(function(E){z.setData(E.getParameter("data"));});this._oDataProvider.attachError(function(E){this._handleError("Data service unavailable. "+E.getParameter("message"));this.onDataRequestComplete();}.bind(this));this._oDataProvider.triggerDataUpdate();}else{this.fireEvent("_cardReady");}};y.prototype._applyServiceManifestSettings=function(){var e=this._oCardManifest.get(M.SERVICES);if(!e){return;}if(!this._oServiceManager){this._oServiceManager=new S(e,this);}};y.prototype.getCardHeader=function(){return this.getAggregation("_header");};y.prototype.getCardHeaderPosition=function(){if(!this._oCardManifest){return"Top";}return this._oCardManifest.get(M.HEADER_POSITION)||u.Top;};y.prototype.getCardContent=function(){return this.getAggregation("_content");};y.prototype._getActionsToolbar=function(){if(!this._oActionsToolbar){this._oActionsToolbar=new A();this._oActionsToolbar.setCard(this);}return this._oActionsToolbar;};y.prototype._applyHeaderManifestSettings=function(){var e=this.createHeader();this.destroyAggregation("_header");if(!e){this.fireEvent("_headerReady");return;}this.setAggregation("_header",e);if(e.isReady()){this.fireEvent("_headerReady");}else{e.attachEvent("_ready",function(){this.fireEvent("_headerReady");}.bind(this));}};y.prototype._applyFilterBarManifestSettings=function(){var e=this.createFilterBar();this.destroyAggregation("_filterBar");if(!e){this.fireEvent("_filterBarReady");return;}e.attachEventOnce("_filterBarDataReady",function(){this.fireEvent("_filterBarReady");}.bind(this));this.setAggregation("_filterBar",e);};y.prototype.getHostInstance=function(){var e=this.getHost();if(!e){return null;}return C.byId(e);};y.prototype._applyContentManifestSettings=function(){var e=this._oCardManifest.get(M.TYPE),z=this.getContentManifest(),E=e+" "+this._oRb.getText("ARIA_ROLEDESCRIPTION_CARD");this._ariaText.setText(E);if(!z){this.fireEvent("_contentReady");return;}this._setTemporaryContent(e,z);if(this._bIsPreviewMode){this.fireEvent("_contentReady");return;}this._createContentPromise=this.createContent({cardType:e,contentManifest:z,serviceManager:this._oServiceManager,dataProviderFactory:this._oDataProviderFactory,iconFormatter:this._oIconFormatter,appId:this._sAppId}).then(function(G){this._setCardContent(G);return G;}.bind(this));this._createContentPromise.catch(function(G){if(G){this._handleError(G);}}.bind(this));};y.prototype.createHeader=function(){var e=this._oCardManifest.get(M.HEADER),z=new n(this);return z.create(e,this._getActionsToolbar());};y.prototype.createFilterBar=function(){var e=this._oCardManifest.get(M.FILTERS),z=this.getModel("filters"),E=z.getProperty("/"),G=new r(this);return G.create(e,E);};y.prototype.getContentManifest=function(){var e=this._oCardManifest.get(M.TYPE),z=e&&e.toLowerCase()==="component",E=this._oCardManifest.get(M.CONTENT),G=!!E;if(G&&!e){L.error("Card type property is mandatory!");return null;}if(!G&&!z){return null;}if(z){E=m(E,{componentManifest:this._oCardManifest.getJson()});}return E;};y.prototype.createContent=function(e){e.cardManifest=this._oCardManifest;return this._oContentFactory.create(e);};y.prototype.onAfterRendering=function(){var e;if(this._oCardManifest&&this._oCardManifest.get(M.TYPE)){e=this._oCardManifest.get(M.TYPE).toLowerCase();}this.toggleStyleClass("sapFCardAnalytical",e==="analytical");};y.prototype._setCardContent=function(e){if(this._bShowContentLoadingPlaceholders){e.showLoadingPlaceholders();this._bShowContentLoadingPlaceholders=false;}e.attachEvent("_error",function(E){this._handleError(E.getParameter("logMessage"),E.getParameter("displayMessage"));}.bind(this));var P=this.getAggregation("_content");if(P&&P!==this._oTemporaryContent){P.destroy();}this.setAggregation("_content",e);if(e.isReady()){this.fireEvent("_contentReady");}else{e.attachEvent("_ready",function(){this.fireEvent("_contentReady");}.bind(this));}};y.prototype._setTemporaryContent=function(e,z){var E=this._getTemporaryContent(e,z),P=this.getAggregation("_content");if(P&&P!==E){P.destroy();}this.setAggregation("_content",E);};y.prototype._handleError=function(e,z){L.error(e);this.fireEvent("_error",{message:e});var E="Unable to load the data.",G=z||E,P=this.getAggregation("_content");var K=new H({justifyContent:"Center",alignItems:"Center",items:[new b({src:"sap-icon://message-error",size:"1rem"}).addStyleClass("sapUiTinyMargin"),new T({text:G})]}).addStyleClass("sapFCardErrorContent");if(P&&!P.hasStyleClass("sapFCardErrorContent")){P.destroy();if(P===this._oTemporaryContent){this._oTemporaryContent=null;}this.fireEvent("_contentReady");}K.addEventDelegate({onAfterRendering:function(){if(!this._oCardManifest){return;}var N=this._oCardManifest.get(M.TYPE),Q=this._oCardManifest.get(M.CONTENT),U=this._oContentFactory.getClass(N),V;if(!U){return;}V=U.getMetadata().getRenderer().getMinHeight(Q,K);if(this.getHeight()==="auto"){K.$().css({"min-height":V});}}},this);this.setAggregation("_content",K);};y.prototype._getTemporaryContent=function(e,z){var E=this.getAggregation("_loadingProvider");if(!this._oTemporaryContent&&E){this._oTemporaryContent=E.createContentPlaceholder(z,e);this._oTemporaryContent.addEventDelegate({onAfterRendering:function(){if(!this._oCardManifest){return;}var G=this._oContentFactory.getClass(e).getMetadata().getRenderer().getMinHeight(z,this._oTemporaryContent);if(this.getHeight()==="auto"){this._oTemporaryContent.$().css({"min-height":G});}}},this);}return this._oTemporaryContent;};y.prototype.setDataMode=function(e){if(this._oDataProviderFactory&&e===v.Inactive){this._oDataProviderFactory.destroy();this._oDataProviderFactory=null;}this.setProperty("dataMode",e,true);if(this.getProperty("dataMode")===v.Active){this.refresh();}return this;};y.prototype.loadDesigntime=function(){if(this._oDesigntime){return Promise.resolve(this._oDesigntime);}if(!this._oCardManifest){return new Promise(function(z,E){this.attachManifestReady(function(){this.loadDesigntime().then(z,E);}.bind(this));}.bind(this));}var e=this._oCardManifest.get("/sap.app/id");if(!e){return Promise.reject("App id not maintained");}return new Promise(function(z,E){var G=this._oCardManifest.get("/sap.card/designtime"),K=this._oCardManifest.get("/sap.app/id").replace(/\./g,"/")+"/"+G;if(K){sap.ui.require([K],function(N){N=new N();N._readyPromise(this._oLimitedInterface,this).then(function(){this._oDesigntime=N;z(N);}.bind(this));}.bind(this),function(){E({error:K+" not found"});});}else{E();}}.bind(this));};y.prototype.showLoadingPlaceholders=function(e){var z;switch(e){case x.Header:z=this.getCardHeader();if(z){z.showLoadingPlaceholders();}break;case x.Filters:z=this.getAggregation("_filterBar");if(z){z.getItems().forEach(function(E){E.showLoadingPlaceholders();});}break;case x.Content:if(this._createContentPromise){this._createContentPromise.then(function(E){E.showLoadingPlaceholders();});}else{this._bShowContentLoadingPlaceholders=true;}break;default:this.showLoadingPlaceholders(x.Header);this.showLoadingPlaceholders(x.Filters);this.showLoadingPlaceholders(x.Content);this.getAggregation("_loadingProvider").setLoading(true);}return this;};y.prototype.hideLoadingPlaceholders=function(e){var z;switch(e){case x.Header:z=this.getCardHeader();if(z){z.hideLoadingPlaceholders();}break;case x.Filters:z=this.getAggregation("_filterBar");if(z){z.getItems().forEach(function(E){E.hideLoadingPlaceholders();});}break;case x.Content:if(this._createContentPromise){this._createContentPromise.then(function(E){E.hideLoadingPlaceholders();});}else{this._bShowContentLoadingPlaceholders=false;}break;default:this.hideLoadingPlaceholders(x.Header);this.hideLoadingPlaceholders(x.Filters);this.hideLoadingPlaceholders(x.Content);this.getAggregation("_loadingProvider").setLoading(false);}return this;};y.prototype.isLoading=function(){var e=this.getAggregation("_loadingProvider");return e?e.getLoading():false;};y.prototype.getFocusDomRef=function(){var e=this.getCardHeader();if(e&&e.getDomRef()){return e.getDomRef();}return this.getDomRef();};y.prototype._showLoadingPlaceholders=function(){this.getAggregation("_loadingProvider").setLoading(true);};y.prototype.onDataRequestComplete=function(){this.fireEvent("_cardReady");this.hideLoadingPlaceholders();};y.prototype.request=function(e){return this._oDataProviderFactory.create({request:e}).setAllowCustomDataType(true).getData();};y.prototype.triggerAction=function(e){s.fireAction({card:this,host:this.getHostInstance(),action:e,parameters:e.parameters,source:this});};y.prototype._setPreviewMode=function(e){this._bIsPreviewMode=e;if(e){this.addStyleClass("sapFCardPreview");}else{this.removeStyleClass("sapFCardPreview");}this._bApplyManifest=true;this.invalidate();};y.prototype.getBindingNamespaces=function(){var N={},e=this.getAggregation("_extension");if(e){N.extension={formatters:e.getFormatters()};}return N;};y.prototype._registerCustomModels=function(){var e=this._oCardManifest.findDataSections();if(!this._aCustomModels){this._aCustomModels=[];}e.forEach(function(z){var E=z&&z.name;if(!E){return;}if(t.indexOf(E)>0){L.error("The model name (data section name) '"+E+"' is reserved for cards. Can not be used for creating a custom model.");return;}if(this._aCustomModels.indexOf(E)>0){L.error("The model name (data section name) '"+E+"' is already used.");return;}this.setModel(new O(),E);this._aCustomModels.push(E);}.bind(this));};y.prototype._deregisterCustomModels=function(){if(!this._aCustomModels){return;}this._aCustomModels.forEach(function(e){this.getModel(e).destroy();this.setModel(null,e);}.bind(this));this._aCustomModels=[];};return y;});
